<!DOCTYPE HTML>
<html>
  <head>
    <title>Citation generator | C[1]</title>
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <style class="mine">.active,button,select,span.b{font-weight:700}.container,img.logo,input.new{position:relative}.container,.footer{min-width:700px;max-width:800px}@-webkit-keyframes green{from{background-color:rgba(0,150,0,.7)}to{background-color:rgba(255,255,255,0)}}@keyframes green{from{background-color:rgba(0,150,0,.7)}to{background-color:rgba(255,255,255,0)}}body{padding:0;overflow-y:scroll}a:-webkit-any-link{color:#36b}a:-webkit-any-link:visited{color:#36b}button,select{-moz-box-shadow:inset 0 1px 0 0 #fff;-webkit-box-shadow:inset 0 1px 0 0 #fff;box-shadow:inset 0 1px 0 0 #fff;background:-webkit-gradient(linear,left top,left bottom,color-stop(.05,#f9f9f9),color-stop(1,#e9e9e9));background:-moz-linear-gradient(top,#f9f9f9 5%,#e9e9e9 100%);background:-webkit-linear-gradient(top,#f9f9f9 5%,#e9e9e9 100%);background:-o-linear-gradient(top,#f9f9f9 5%,#e9e9e9 100%);background:-ms-linear-gradient(top,#f9f9f9 5%,#e9e9e9 100%);background:linear-gradient(to bottom,#f9f9f9 5%,#e9e9e9 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#f9f9f9', endColorstr='#e9e9e9', GradientType=0);background-color:#f9f9f9;-moz-border-radius:6px;-webkit-border-radius:6px;border-radius:6px;border:1px solid #dcdcdc;display:inline-block;cursor:pointer;color:#666;font-family:Arial;font-size:15px;padding:3px 7px;text-decoration:none;text-shadow:0 1px 0 #fff}.inputtype:not(.activeinputtype),.invisible{display:none}button:hover,select:hover{background:-webkit-gradient(linear,left top,left bottom,color-stop(.05,#e9e9e9),color-stop(1,#f9f9f9));background:-moz-linear-gradient(top,#e9e9e9 5%,#f9f9f9 100%);background:-webkit-linear-gradient(top,#e9e9e9 5%,#f9f9f9 100%);background:-o-linear-gradient(top,#e9e9e9 5%,#f9f9f9 100%);background:-ms-linear-gradient(top,#e9e9e9 5%,#f9f9f9 100%);background:linear-gradient(to bottom,#e9e9e9 5%,#f9f9f9 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#e9e9e9', endColorstr='#f9f9f9', GradientType=0);background-color:#e9e9e9}.footer,.warning{background-color:#fff}button:active,select:hover{position:relative;top:1px}button.option-button{padding:1.5px 5px;margin-left:5px}.container{width:50%;margin:0 auto;font-family:RobotoDraft,Roboto,'Helvetica Neue',sans-serif}.container section:last-of-type{margin-bottom:30px}.container .lang .options{float:right}.container .header{margin-bottom:50px}.container .header h1{width:100%;text-align:center;margin:20px 0 30px}.container .input legend{margin-top:10px}.container .citations{margin-top:20px;padding:0 12px;max-height:300px;overflow-y:auto}.container p{font-size:14px}span.i{font-style:italic}i{font-style:normal}p.indent1{text-indent:15px}
.nomargin{margin-bottom:10px}.nomargin>p{margin:0}img.logo{float:left;margin-left:12px;top:-20px}button:focus,input:focus,select:focus{outline:0}fieldset{border:1px silver;margin:0 2px;padding:.35em .625em .75em}input.title,input[type=url]{width:300px}.inputtypechoice{padding-left:12px;font-size:14px;margin-bottom:10px}textarea.JSON,textarea.BibTeX{width:100%;height:300px;}.inputtypechoice a:visited,.inputtypechoice a{color:#000;text-decoration:none}input.new{margin-left:30px}h2,section>p{margin-left:12px}h2{border-bottom:3px solid #000;width:100%}h2:after{content:'.'}.footer{position:fixed;width:50%;margin:0 auto;height:20px;bottom:0;font-size:12px;padding:5px 12px}.wikipedia,h3{padding-left:12px}.wikipedia{width:100%}.warning{color:#8b0000;padding:5px;border-radius:7px;-webkit-transition:color .2s ease-in-out,background-color .2s ease-in-out;transition:color .2s ease-in-out,background-color .2s ease-in-out}.warning:hover{color:#fff;background-color:#8b0000}.link:after{padding-left:5px;content:url('data:image/svg+xml,<%3Fxml%20version%3D"1.0"%20encoding%3D"UTF-8"%3F><svg%20xmlns%3D"http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg"%20width%3D"10"%20height%3D"10"><g%20transform%3D"translate%28-826.429%20-698.791%29"><rect%20width%3D"5.982"%20height%3D"5.982"%20x%3D"826.929"%20y%3D"702.309"%20fill%3D"%23fff"%20stroke%3D"%2306c"%2F><g><path%20d%3D"M831.194%20698.791h5.234v5.391l-1.571%201.545-1.31-1.31-2.725%202.725-2.689-2.689%202.808-2.808-1.311-1.311z"%20fill%3D"%2306f"%2F><path%20d%3D"M835.424%20699.795l.022%204.885-1.817-1.817-2.881%202.881-1.228-1.228%202.881-2.881-1.851-1.851z"%20fill%3D"%23fff"%2F><%2Fg><%2Fg><%2Fsvg>')}button.add{margin-left:12px}.draft{max-height:250px;min-height:20px;margin:10px 0 20px 12px;overflow-y:auto}.green{-webkit-animation:green 3s ease-out 0s 1;animation:green 3s ease-out 0s 1}.citation{padding:5px;border-radius:5px;}@media print{body * { visibility: hidden; }.container:not(.invisible) .citations *{ visibility: visible; }.container:not(.invisible) .citations{ position: absolute; top: 40px; left: 30px; }}</style>
    <link rel="shortcut icon" type="image/png" href="data:image/png;base64,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"/>
  </head>
  <body>
  </body>
    <div class="container en">
      <div class="footer"><sup>[1]</sup><span class="b">:</span> No guarantee for succes</div>
      <div class="header">
      <img class="logo" height="88px" src="data:image/png;base64,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"/>
      <div class="lang">
	<div class="options">
	  <a class="nl" href="#"><img height="10px" src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/20/Flag_of_the_Netherlands.svg/125px-Flag_of_the_Netherlands.svg.png"/></a> | 
	  <a class="en" href="#"><img height="10px" src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/ae/Flag_of_the_United_Kingdom.svg/120px-Flag_of_the_United_Kingdom.svg.png"/></a>
<!-- 	  <button class="options"><i class="fa fa-cog"></i></button> -->
	</div>
      </div>
      <h1>Generate citations</h1>
      </div>
      
      <section> 
      
      <h2>Input</h2>
    
      <div class="input">
	
	<div class="inputtypechoice">
	  <a class="active" href="#">Input</a> | <a href="#" >JSON</a> | <a href="#">BibTeX</a>
	</div>
	
	<div class="inputtype inputtypejson">
	<section>
	<p class="warning"><i class="fa fa-exclamation-triangle"></i> Only simple objects; values can only be strings or numbers</p>
	<fieldset>
	<select class="type">
	  <option value="book">Book</option>
	  <option value="chapter">Chapter</option>
	  <option value="article">Article</option>
	  <option value="e-article">E-article</option>
	  <option value="e-publication">E-publication</option>
	  <option value="paper">Paper</option>
	  <option value="newspaper-article">Newspaper</option>
	</select>
	</fieldset>
	  <fieldset>
	    <textarea class="JSON" placeholder="e.g. '{ author:'Jan van der Linden' }'"></textarea>
	  </fieldset>
	  </section>
	</div>
	
	<div class="inputtype inputtypebibtex">
	<section>
	  <fieldset>
	    <textarea class="BibTeX" placeholder="e.g. '@book{aarts2001titel,title={{Titel}},author={Aarts, J.},year={2001},publisher={Uitgever},}'"></textarea>
	  </fieldset>
	</section>
	</div>
	
	<div class="change inputtype inputtypeinput activeinputtype">
	
	<fieldset>
	<select class="type">
	  <option value="book">Book</option>
	  <option value="chapter">Chapter</option>
	  <option value="article">Article</option>
	  <option value="e-article">E-article</option>
	  <option value="e-publication">E-publication</option>
	  <option value="paper">Paper</option>
	  <option value="newspaper-article">Newspaper</option>
	</select>
	</fieldset>
	
	<div class="infoinput" >
	
	<fieldset class="chapter">
	  <legend>Chapter author(s):</legend>
	  <input class="chapauthor" placeholder="e.g. 'Jan van der Linden'" type="text"></input>
	</fieldset>
	
	<fieldset class="chapter">
	  <legend>Chapter:</legend>
	  <input class="chapter" placeholder="e.g. 'Chapter 1'" type="text"></input>
	</fieldset>
	
	<fieldset class="book chapter article e-article e-publication paper newspaper-article">
	  <legend>Author(s):</legend>
	  <input class="author" placeholder="e.g. 'Jan van der Linden'" type="text"></input>
	</fieldset>
	
	<fieldset class="book chapter">
	  <legend>Redactor(s):</legend>
	  <input class="red" placeholder="e.g. 'Jan Bosch'" type="text"></input>
	</fieldset>
	
	<fieldset class="article e-publication newspaper-article">
	  <legend>Publication date:</legend>
	  <input class="pubdate" type="date"></input>
	</fieldset>
	
	<fieldset class="e-article e-publication">
	  <legend>Citated on:</legend>
	  <input class="date" type="date"></input>
	</fieldset>
	
	<fieldset class="book e-article chapter article paper">
	  <legend>Year:</legend>
	  <input class="year" placeholder="e.g. '2015'" type="number" min="1950"></input>
	</fieldset>
	
	<fieldset class="book chapter article e-article e-publication paper newspaper-article">
	  <legend>Title (of article, book):</legend>
	  <input class="title" placeholder="e.g. 'Harry Potter and the philosophers stone'" type="text"></input>
	</fieldset>
	
	<fieldset class="article e-article e-publication newspaper-article">
	  <legend>Journal:</legend>
	  <input class="journal" placeholder="e.g. 'Science'" type="text"></input>
	</fieldset>
	
	<fieldset class="article e-article journal">
	  <legend>Volume:</legend>
	  <input class="volume" placeholder="e.g. '31'" type="number"></input>
	</fieldset>
	
	<fieldset class="article e-article journal">
	  <legend>Number:</legend>
	  <input class="number" placeholder="e.g. '2'" type="number"></input>
	</fieldset>
	
	<fieldset class="paper">
	  <legend>Paper from conference:</legend>
	  <input class="conname" placeholder="e.g. 'IEEE International Conf...'" type="text"></input>
	  From <input class="condate from" type="date"></input> until <input class="condate to" type="date"></input><br/><br/>
	  At <input class="conorg" placeholder="e.g. 'TU/e' or 'Maastricht University'" type="text"></input>
	  in <input class="conplace" placeholder="e.g. 'London'" type="text"></input> in <div style="display:inline-block;">
	  <select class="concountry" name="country">
<option value="">Country...</option>
<option value="Afganistan">Afghanistan</option>
<option value="Albania">Albania</option>
<option value="Algeria">Algeria</option>
<option value="American Samoa">American Samoa</option>
<option value="Andorra">Andorra</option>
<option value="Angola">Angola</option>
<option value="Anguilla">Anguilla</option>
<option value="Antigua &amp; Barbuda">Antigua &amp; Barbuda</option>
<option value="Argentina">Argentina</option>
<option value="Armenia">Armenia</option>
<option value="Aruba">Aruba</option>
<option value="Australia">Australia</option>
<option value="Austria">Austria</option>
<option value="Azerbaijan">Azerbaijan</option>
<option value="Bahamas">Bahamas</option>
<option value="Bahrain">Bahrain</option>
<option value="Bangladesh">Bangladesh</option>
<option value="Barbados">Barbados</option>
<option value="Belarus">Belarus</option>
<option value="Belgium">Belgium</option>
<option value="Belize">Belize</option>
<option value="Benin">Benin</option>
<option value="Bermuda">Bermuda</option>
<option value="Bhutan">Bhutan</option>
<option value="Bolivia">Bolivia</option>
<option value="Bonaire">Bonaire</option>
<option value="Bosnia &amp; Herzegovina">Bosnia &amp; Herzegovina</option>
<option value="Botswana">Botswana</option>
<option value="Brazil">Brazil</option>
<option value="British Indian Ocean Ter">British Indian Ocean Ter</option>
<option value="Brunei">Brunei</option>
<option value="Bulgaria">Bulgaria</option>
<option value="Burkina Faso">Burkina Faso</option>
<option value="Burundi">Burundi</option>
<option value="Cambodia">Cambodia</option>
<option value="Cameroon">Cameroon</option>
<option value="Canada">Canada</option>
<option value="Canary Islands">Canary Islands</option>
<option value="Cape Verde">Cape Verde</option>
<option value="Cayman Islands">Cayman Islands</option>
<option value="Central African Republic">Central African Republic</option>
<option value="Chad">Chad</option>
<option value="Channel Islands">Channel Islands</option>
<option value="Chile">Chile</option>
<option value="China">China</option>
<option value="Christmas Island">Christmas Island</option>
<option value="Cocos Island">Cocos Island</option>
<option value="Colombia">Colombia</option>
<option value="Comoros">Comoros</option>
<option value="Congo">Congo</option>
<option value="Cook Islands">Cook Islands</option>
<option value="Costa Rica">Costa Rica</option>
<option value="Cote DIvoire">Cote D'Ivoire</option>
<option value="Croatia">Croatia</option>
<option value="Cuba">Cuba</option>
<option value="Curaco">Curacao</option>
<option value="Cyprus">Cyprus</option>
<option value="Czech Republic">Czech Republic</option>
<option value="Denmark">Denmark</option>
<option value="Djibouti">Djibouti</option>
<option value="Dominica">Dominica</option>
<option value="Dominican Republic">Dominican Republic</option>
<option value="East Timor">East Timor</option>
<option value="Ecuador">Ecuador</option>
<option value="Egypt">Egypt</option>
<option value="El Salvador">El Salvador</option>
<option value="Equatorial Guinea">Equatorial Guinea</option>
<option value="Eritrea">Eritrea</option>
<option value="Estonia">Estonia</option>
<option value="Ethiopia">Ethiopia</option>
<option value="Falkland Islands">Falkland Islands</option>
<option value="Faroe Islands">Faroe Islands</option>
<option value="Fiji">Fiji</option>
<option value="Finland">Finland</option>
<option value="France">France</option>
<option value="French Guiana">French Guiana</option>
<option value="French Polynesia">French Polynesia</option>
<option value="French Southern Ter">French Southern Ter</option>
<option value="Gabon">Gabon</option>
<option value="Gambia">Gambia</option>
<option value="Georgia">Georgia</option>
<option value="Germany">Germany</option>
<option value="Ghana">Ghana</option>
<option value="Gibraltar">Gibraltar</option>
<option value="Great Britain">Great Britain</option>
<option value="Greece">Greece</option>
<option value="Greenland">Greenland</option>
<option value="Grenada">Grenada</option>
<option value="Guadeloupe">Guadeloupe</option>
<option value="Guam">Guam</option>
<option value="Guatemala">Guatemala</option>
<option value="Guinea">Guinea</option>
<option value="Guyana">Guyana</option>
<option value="Haiti">Haiti</option>
<option value="Hawaii">Hawaii</option>
<option value="Honduras">Honduras</option>
<option value="Hong Kong">Hong Kong</option>
<option value="Hungary">Hungary</option>
<option value="Iceland">Iceland</option>
<option value="India">India</option>
<option value="Indonesia">Indonesia</option>
<option value="Iran">Iran</option>
<option value="Iraq">Iraq</option>
<option value="Ireland">Ireland</option>
<option value="Isle of Man">Isle of Man</option>
<option value="Israel">Israel</option>
<option value="Italy">Italy</option>
<option value="Jamaica">Jamaica</option>
<option value="Japan">Japan</option>
<option value="Jordan">Jordan</option>
<option value="Kazakhstan">Kazakhstan</option>
<option value="Kenya">Kenya</option>
<option value="Kiribati">Kiribati</option>
<option value="Korea North">Korea North</option>
<option value="Korea Sout">Korea South</option>
<option value="Kuwait">Kuwait</option>
<option value="Kyrgyzstan">Kyrgyzstan</option>
<option value="Laos">Laos</option>
<option value="Latvia">Latvia</option>
<option value="Lebanon">Lebanon</option>
<option value="Lesotho">Lesotho</option>
<option value="Liberia">Liberia</option>
<option value="Libya">Libya</option>
<option value="Liechtenstein">Liechtenstein</option>
<option value="Lithuania">Lithuania</option>
<option value="Luxembourg">Luxembourg</option>
<option value="Macau">Macau</option>
<option value="Macedonia">Macedonia</option>
<option value="Madagascar">Madagascar</option>
<option value="Malaysia">Malaysia</option>
<option value="Malawi">Malawi</option>
<option value="Maldives">Maldives</option>
<option value="Mali">Mali</option>
<option value="Malta">Malta</option>
<option value="Marshall Islands">Marshall Islands</option>
<option value="Martinique">Martinique</option>
<option value="Mauritania">Mauritania</option>
<option value="Mauritius">Mauritius</option>
<option value="Mayotte">Mayotte</option>
<option value="Mexico">Mexico</option>
<option value="Midway Islands">Midway Islands</option>
<option value="Moldova">Moldova</option>
<option value="Monaco">Monaco</option>
<option value="Mongolia">Mongolia</option>
<option value="Montserrat">Montserrat</option>
<option value="Morocco">Morocco</option>
<option value="Mozambique">Mozambique</option>
<option value="Myanmar">Myanmar</option>
<option value="Nambia">Nambia</option>
<option value="Nauru">Nauru</option>
<option value="Nepal">Nepal</option>
<option value="Netherland Antilles">Netherland Antilles</option>
<option value="Netherlands">Netherlands (Holland, Europe)</option>
<option value="Nevis">Nevis</option>
<option value="New Caledonia">New Caledonia</option>
<option value="New Zealand">New Zealand</option>
<option value="Nicaragua">Nicaragua</option>
<option value="Niger">Niger</option>
<option value="Nigeria">Nigeria</option>
<option value="Niue">Niue</option>
<option value="Norfolk Island">Norfolk Island</option>
<option value="Norway">Norway</option>
<option value="Oman">Oman</option>
<option value="Pakistan">Pakistan</option>
<option value="Palau Island">Palau Island</option>
<option value="Palestine">Palestine</option>
<option value="Panama">Panama</option>
<option value="Papua New Guinea">Papua New Guinea</option>
<option value="Paraguay">Paraguay</option>
<option value="Peru">Peru</option>
<option value="Phillipines">Philippines</option>
<option value="Pitcairn Island">Pitcairn Island</option>
<option value="Poland">Poland</option>
<option value="Portugal">Portugal</option>
<option value="Puerto Rico">Puerto Rico</option>
<option value="Qatar">Qatar</option>
<option value="Republic of Montenegro">Republic of Montenegro</option>
<option value="Republic of Serbia">Republic of Serbia</option>
<option value="Reunion">Reunion</option>
<option value="Romania">Romania</option>
<option value="Russia">Russia</option>
<option value="Rwanda">Rwanda</option>
<option value="St Barthelemy">St Barthelemy</option>
<option value="St Eustatius">St Eustatius</option>
<option value="St Helena">St Helena</option>
<option value="St Kitts-Nevis">St Kitts-Nevis</option>
<option value="St Lucia">St Lucia</option>
<option value="St Maarten">St Maarten</option>
<option value="St Pierre &amp; Miquelon">St Pierre &amp; Miquelon</option>
<option value="St Vincent &amp; Grenadines">St Vincent &amp; Grenadines</option>
<option value="Saipan">Saipan</option>
<option value="Samoa">Samoa</option>
<option value="Samoa American">Samoa American</option>
<option value="San Marino">San Marino</option>
<option value="Sao Tome &amp; Principe">Sao Tome &amp; Principe</option>
<option value="Saudi Arabia">Saudi Arabia</option>
<option value="Senegal">Senegal</option>
<option value="Serbia">Serbia</option>
<option value="Seychelles">Seychelles</option>
<option value="Sierra Leone">Sierra Leone</option>
<option value="Singapore">Singapore</option>
<option value="Slovakia">Slovakia</option>
<option value="Slovenia">Slovenia</option>
<option value="Solomon Islands">Solomon Islands</option>
<option value="Somalia">Somalia</option>
<option value="South Africa">South Africa</option>
<option value="Spain">Spain</option>
<option value="Sri Lanka">Sri Lanka</option>
<option value="Sudan">Sudan</option>
<option value="Suriname">Suriname</option>
<option value="Swaziland">Swaziland</option>
<option value="Sweden">Sweden</option>
<option value="Switzerland">Switzerland</option>
<option value="Syria">Syria</option>
<option value="Tahiti">Tahiti</option>
<option value="Taiwan">Taiwan</option>
<option value="Tajikistan">Tajikistan</option>
<option value="Tanzania">Tanzania</option>
<option value="Thailand">Thailand</option>
<option value="Togo">Togo</option>
<option value="Tokelau">Tokelau</option>
<option value="Tonga">Tonga</option>
<option value="Trinidad &amp; Tobago">Trinidad &amp; Tobago</option>
<option value="Tunisia">Tunisia</option>
<option value="Turkey">Turkey</option>
<option value="Turkmenistan">Turkmenistan</option>
<option value="Turks &amp; Caicos Is">Turks &amp; Caicos Is</option>
<option value="Tuvalu">Tuvalu</option>
<option value="Uganda">Uganda</option>
<option value="Ukraine">Ukraine</option>
<option value="United Arab Erimates">United Arab Emirates</option>
<option value="United Kingdom">United Kingdom</option>
<option value="United States of America">United States of America</option>
<option value="Uraguay">Uruguay</option>
<option value="Uzbekistan">Uzbekistan</option>
<option value="Vanuatu">Vanuatu</option>
<option value="Vatican City State">Vatican City State</option>
<option value="Venezuela">Venezuela</option>
<option value="Vietnam">Vietnam</option>
<option value="Virgin Islands (Brit)">Virgin Islands (Brit)</option>
<option value="Virgin Islands (USA)">Virgin Islands (USA)</option>
<option value="Wake Island">Wake Island</option>
<option value="Wallis &amp; Futana Is">Wallis &amp; Futana Is</option>
<option value="Yemen">Yemen</option>
<option value="Zaire">Zaire</option>
<option value="Zambia">Zambia</option>
<option value="Zimbabwe">Zimbabwe</option>
</select>
	      </div>
	</fieldset>
	
	<fieldset class="chapter article e-article paper newspaper-article">
	  <legend>Pages:</legend>
	  <input class="pages from" placeholder="e.g. '1'" type="number"></input><input class="pages to" placeholder="e.g. '5'" type="number"></input>
	</fieldset>
	
	<fieldset class="e-article e-publication">
	  <legend>URL:</legend>
	  <input class="url" placeholder="e.g. 'en.wikipedia.org/wiki/APA_style'" type="url"></input>
	</fieldset>
	
	<fieldset class="book chapter">
	  <legend>Print:</legend>
	  <input class="print" placeholder="e.g. '3'" type="number"></input>
	</fieldset>
	
	<fieldset class="book chapter">
	  <legend>Place:</legend>
	  <input class="place" placeholder="e.g. 'London'" type="text"></input>
	</fieldset>
	
	<fieldset class="book chapter">
	  <legend>Publisher:</legend>
	  <input class="publisher" placeholder="e.g. 'Penguin'" type="text"></input>
	</fieldset>
	
	</div>
	</div>	
      </div>
      
      <div class="draft"></div>
      
      <button class="add" ><i class="fa fa-plus"></i> Add</button>
      <button><i class="fa fa-trash-o"></i> Delete draft</button>
    
      </section>
      <section>

	<h2>Edit</h2>
	
	<fieldset>
	<select class="format">
	  <option value="APA">APA</option>
	  <option value="Vancouver">Vancouver</option>
	  <option value="JSON">JSON</option>
	  <option value="BibTeX">BibTeX</option>
	</select>
	</fieldset>
      
	<div class="wikipedia"">
	  <!--<h3 class="wikititle"></h3> -->
	  <p class="wikiextract"></p>
	</div>

	<fieldset class="buttons">
	  <button><i class="fa fa-sort"></i> Sort</button>
	  <button><i class="fa fa-trash-o"></i> Clear</button>
	</fieldset>
	
	<p>Following element is editable</p>
	
      <div class="citations">
	<div class="citation activecitation" contenteditable="true" spellcheck="false"></div>
      </div>
      
    </section>
    <section>
    
      <h2>Output</h2>
      
<!--       <p class="warning"><i class="fa fa-exclamation-triangle"></i> You can't copy rich text (yet), so you'll have to put the title in italics in your word processor or copy the citations yourselfs</p> -->
      
      <fieldset class="buttons">
<!-- 	<button><i class="fa fa-files-o"></i> Copy</button> -->
	<button><i class="fa fa-download"></i> Download</button>
	<button><i class="fa fa-print"></i> Print</button>
      </fieldset>
    
    </section>
    
    </div>
    <div class="container nl">
      <div class="footer"><sup>[1]</sup><span class="b">:</span> Geen garantie op succes</div>
      <div class="header">
      <img class="logo" height="88px" src="data:image/png;base64,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"/>
      <div class="lang">
	<div class="options">
	  <a class="nl" href="#"><img height="10px" src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/20/Flag_of_the_Netherlands.svg/125px-Flag_of_the_Netherlands.svg.png"/></a> | 
	  <a class="en" href="#"><img height="10px" src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/ae/Flag_of_the_United_Kingdom.svg/120px-Flag_of_the_United_Kingdom.svg.png"/></a>
<!-- 	  <button class="option-button"><i class="fa fa-cog"></i></button> -->
	</div>
      </div>
      <h1>Bronnen maken</h1>
    
      </div>
    
      <section> 
      
      <h2>Invullen</h2>
    
      <div class="input">
	
	<div class="inputtypechoice">
	  <a class="active" href="#">Input</a> | <a href="#" >JSON</a> | <a href="#">BibTeX</a>
	</div>
	
	<div class="inputtype inputtypejson">
	<section>
	<p class="warning"><i class="fa fa-exclamation-triangle"></i> Alleen simpele objecten (waarde mag alleen tekst of getal zijn)</p>
	<fieldset>
	<select class="type">
	  <option value="book">Boek</option>
	  <option value="chapter">Hoofdstuk</option>
	  <option value="article">Artikel</option>
	  <option value="e-article">E-artikel</option>
	  <option value="e-publication">E-publicatie</option>
	  <option value="paper">Paper</option>
	  <option value="newspaper-article">Krantenartikel</option>
	</select>
	</fieldset>
	  <fieldset>
	    <textarea class="JSON" placeholder="bv. '{ author:'Jan van der Linden' }'"></textarea>
	  </fieldset>
	  </section>
	</div>
	
	<div class="inputtype inputtypebibtex">
	  <section>
	  <fieldset>
	    <textarea class="BibTeX" placeholder="bv. '@book{aarts2001titel,title={{Titel}},author={Aarts, J.},year={2001},publisher={Uitgever},}'"></textarea>
	  </fieldset>
	  </section>
	</div>
	
	<div class="change inputtype inputtypeinput activeinputtype">
	
	<fieldset>
	<select class="type">
	  <option value="book">Boek</option>
	  <option value="chapter">Hoofdstuk</option>
	  <option value="article">Artikel</option>
	  <option value="e-article">E-artikel</option>
	  <option value="e-publication">E-publicatie</option>
	  <option value="paper">Paper</option>
	  <option value="newspaper-article">Krantenartikel</option>
	</select>
	</fieldset>
	
	<div class="infoinput" >
	
	<fieldset class="chapter">
	  <legend>Auteurs hoofdstuk:</legend>
	  <input class="chapauthor" placeholder="bv. 'Jan van der Linden'" type="text"></input>
	</fieldset>
	
	<fieldset class="chapter">
	  <legend>Hoofdstuk:</legend>
	  <input class="chapter" placeholder="bv. 'Hoofdstuk 1'" type="text"></input>
	</fieldset>
	
	<fieldset class="book chapter article e-article e-publication paper newspaper-article">
	  <legend>Auteur(s):</legend>
	  <input class="author" placeholder="bv. 'Jan van der Linden'" type="text"></input>
	</fieldset>
	
	<fieldset class="book chapter">
	  <legend>Redacteur(s):</legend>
	  <input class="red" placeholder="bv. 'Jan Bosch'" type="text"></input>
	</fieldset>
	
	<fieldset class="article e-publication newspaper-article">
	  <legend>Publicatiedatum:</legend>
	  <input class="pubdate" type="date"></input>
	</fieldset>
	
	<fieldset class="e-article e-publication">
	  <legend>Binnengehaald op:</legend>
	  <input class="date" type="date"></input>
	</fieldset>
	
	<fieldset class="book e-article chapter article paper">
	  <legend>Jaar:</legend>
	  <input class="year" placeholder="bv. '2015'" type="number" min="1950"></input>
	</fieldset>
	
	<fieldset class="article e-article e-publication newspaper-article">
	  <legend>Tijdschrift:</legend>
	  <input class="journal" placeholder="bv. 'Science'" type="text"></input>
	</fieldset>
	
	<fieldset class="article e-article journal">
	  <legend>Jaargang:</legend>
	  <input class="volume" placeholder="bv. '31'" type="number"></input>
	</fieldset>
	
	<fieldset class="article e-article journal">
	  <legend>Nummer:</legend>
	  <input class="number" placeholder="bv. '2'" type="number"></input>
	</fieldset>
	
	<fieldset class="book chapter article e-article e-publication paper newspaper-article">
	  <legend>Titel (van artikel, boek):</legend>
	  <input class="title" placeholder="bv. '20 000 mijlen onder zee'" type="text"></input>
	</fieldset>
	
	<fieldset class="paper">
	  <legend>Paper van conferentie:</legend>
	  <input class="conname" placeholder="bv. 'IEEE International Conf...'" type="text"></input>
	  Van <input class="condate from" type="date"></input> tot <input class="condate to" type="date"></input><br/><br/>
	  Bij <input class="conorg" placeholder="bv. 'TU/e' of 'Maastricht University'" type="text"></input>
	  in <input class="conplace" placeholder="bv. 'Eindhoven'" type="text"></input> in <div style="display:inline-block;">
	  <select class="concountry" name="country">
<option value="">Land...</option>
<option value="Afganistan">Afghanistan</option>
<option value="Albania">Albania</option>
<option value="Algeria">Algeria</option>
<option value="American Samoa">American Samoa</option>
<option value="Andorra">Andorra</option>
<option value="Angola">Angola</option>
<option value="Anguilla">Anguilla</option>
<option value="Antigua &amp; Barbuda">Antigua &amp; Barbuda</option>
<option value="Argentina">Argentina</option>
<option value="Armenia">Armenia</option>
<option value="Aruba">Aruba</option>
<option value="Australia">Australia</option>
<option value="Austria">Austria</option>
<option value="Azerbaijan">Azerbaijan</option>
<option value="Bahamas">Bahamas</option>
<option value="Bahrain">Bahrain</option>
<option value="Bangladesh">Bangladesh</option>
<option value="Barbados">Barbados</option>
<option value="Belarus">Belarus</option>
<option value="Belgium">Belgium</option>
<option value="Belize">Belize</option>
<option value="Benin">Benin</option>
<option value="Bermuda">Bermuda</option>
<option value="Bhutan">Bhutan</option>
<option value="Bolivia">Bolivia</option>
<option value="Bonaire">Bonaire</option>
<option value="Bosnia &amp; Herzegovina">Bosnia &amp; Herzegovina</option>
<option value="Botswana">Botswana</option>
<option value="Brazil">Brazil</option>
<option value="British Indian Ocean Ter">British Indian Ocean Ter</option>
<option value="Brunei">Brunei</option>
<option value="Bulgaria">Bulgaria</option>
<option value="Burkina Faso">Burkina Faso</option>
<option value="Burundi">Burundi</option>
<option value="Cambodia">Cambodia</option>
<option value="Cameroon">Cameroon</option>
<option value="Canada">Canada</option>
<option value="Canary Islands">Canary Islands</option>
<option value="Cape Verde">Cape Verde</option>
<option value="Cayman Islands">Cayman Islands</option>
<option value="Central African Republic">Central African Republic</option>
<option value="Chad">Chad</option>
<option value="Channel Islands">Channel Islands</option>
<option value="Chile">Chile</option>
<option value="China">China</option>
<option value="Christmas Island">Christmas Island</option>
<option value="Cocos Island">Cocos Island</option>
<option value="Colombia">Colombia</option>
<option value="Comoros">Comoros</option>
<option value="Congo">Congo</option>
<option value="Cook Islands">Cook Islands</option>
<option value="Costa Rica">Costa Rica</option>
<option value="Cote DIvoire">Cote D'Ivoire</option>
<option value="Croatia">Croatia</option>
<option value="Cuba">Cuba</option>
<option value="Curaco">Curacao</option>
<option value="Cyprus">Cyprus</option>
<option value="Czech Republic">Czech Republic</option>
<option value="Denmark">Denmark</option>
<option value="Djibouti">Djibouti</option>
<option value="Dominica">Dominica</option>
<option value="Dominican Republic">Dominican Republic</option>
<option value="East Timor">East Timor</option>
<option value="Ecuador">Ecuador</option>
<option value="Egypt">Egypt</option>
<option value="El Salvador">El Salvador</option>
<option value="Equatorial Guinea">Equatorial Guinea</option>
<option value="Eritrea">Eritrea</option>
<option value="Estonia">Estonia</option>
<option value="Ethiopia">Ethiopia</option>
<option value="Falkland Islands">Falkland Islands</option>
<option value="Faroe Islands">Faroe Islands</option>
<option value="Fiji">Fiji</option>
<option value="Finland">Finland</option>
<option value="France">France</option>
<option value="French Guiana">French Guiana</option>
<option value="French Polynesia">French Polynesia</option>
<option value="French Southern Ter">French Southern Ter</option>
<option value="Gabon">Gabon</option>
<option value="Gambia">Gambia</option>
<option value="Georgia">Georgia</option>
<option value="Germany">Germany</option>
<option value="Ghana">Ghana</option>
<option value="Gibraltar">Gibraltar</option>
<option value="Great Britain">Great Britain</option>
<option value="Greece">Greece</option>
<option value="Greenland">Greenland</option>
<option value="Grenada">Grenada</option>
<option value="Guadeloupe">Guadeloupe</option>
<option value="Guam">Guam</option>
<option value="Guatemala">Guatemala</option>
<option value="Guinea">Guinea</option>
<option value="Guyana">Guyana</option>
<option value="Haiti">Haiti</option>
<option value="Hawaii">Hawaii</option>
<option value="Honduras">Honduras</option>
<option value="Hong Kong">Hong Kong</option>
<option value="Hungary">Hungary</option>
<option value="Iceland">Iceland</option>
<option value="India">India</option>
<option value="Indonesia">Indonesia</option>
<option value="Iran">Iran</option>
<option value="Iraq">Iraq</option>
<option value="Ireland">Ireland</option>
<option value="Isle of Man">Isle of Man</option>
<option value="Israel">Israel</option>
<option value="Italy">Italy</option>
<option value="Jamaica">Jamaica</option>
<option value="Japan">Japan</option>
<option value="Jordan">Jordan</option>
<option value="Kazakhstan">Kazakhstan</option>
<option value="Kenya">Kenya</option>
<option value="Kiribati">Kiribati</option>
<option value="Korea North">Korea North</option>
<option value="Korea Sout">Korea South</option>
<option value="Kuwait">Kuwait</option>
<option value="Kyrgyzstan">Kyrgyzstan</option>
<option value="Laos">Laos</option>
<option value="Latvia">Latvia</option>
<option value="Lebanon">Lebanon</option>
<option value="Lesotho">Lesotho</option>
<option value="Liberia">Liberia</option>
<option value="Libya">Libya</option>
<option value="Liechtenstein">Liechtenstein</option>
<option value="Lithuania">Lithuania</option>
<option value="Luxembourg">Luxembourg</option>
<option value="Macau">Macau</option>
<option value="Macedonia">Macedonia</option>
<option value="Madagascar">Madagascar</option>
<option value="Malaysia">Malaysia</option>
<option value="Malawi">Malawi</option>
<option value="Maldives">Maldives</option>
<option value="Mali">Mali</option>
<option value="Malta">Malta</option>
<option value="Marshall Islands">Marshall Islands</option>
<option value="Martinique">Martinique</option>
<option value="Mauritania">Mauritania</option>
<option value="Mauritius">Mauritius</option>
<option value="Mayotte">Mayotte</option>
<option value="Mexico">Mexico</option>
<option value="Midway Islands">Midway Islands</option>
<option value="Moldova">Moldova</option>
<option value="Monaco">Monaco</option>
<option value="Mongolia">Mongolia</option>
<option value="Montserrat">Montserrat</option>
<option value="Morocco">Morocco</option>
<option value="Mozambique">Mozambique</option>
<option value="Myanmar">Myanmar</option>
<option value="Nambia">Nambia</option>
<option value="Nauru">Nauru</option>
<option value="Nepal">Nepal</option>
<option value="Netherland Antilles">Netherland Antilles</option>
<option value="Netherlands">Netherlands (Holland, Europe)</option>
<option value="Nevis">Nevis</option>
<option value="New Caledonia">New Caledonia</option>
<option value="New Zealand">New Zealand</option>
<option value="Nicaragua">Nicaragua</option>
<option value="Niger">Niger</option>
<option value="Nigeria">Nigeria</option>
<option value="Niue">Niue</option>
<option value="Norfolk Island">Norfolk Island</option>
<option value="Norway">Norway</option>
<option value="Oman">Oman</option>
<option value="Pakistan">Pakistan</option>
<option value="Palau Island">Palau Island</option>
<option value="Palestine">Palestine</option>
<option value="Panama">Panama</option>
<option value="Papua New Guinea">Papua New Guinea</option>
<option value="Paraguay">Paraguay</option>
<option value="Peru">Peru</option>
<option value="Phillipines">Philippines</option>
<option value="Pitcairn Island">Pitcairn Island</option>
<option value="Poland">Poland</option>
<option value="Portugal">Portugal</option>
<option value="Puerto Rico">Puerto Rico</option>
<option value="Qatar">Qatar</option>
<option value="Republic of Montenegro">Republic of Montenegro</option>
<option value="Republic of Serbia">Republic of Serbia</option>
<option value="Reunion">Reunion</option>
<option value="Romania">Romania</option>
<option value="Russia">Russia</option>
<option value="Rwanda">Rwanda</option>
<option value="St Barthelemy">St Barthelemy</option>
<option value="St Eustatius">St Eustatius</option>
<option value="St Helena">St Helena</option>
<option value="St Kitts-Nevis">St Kitts-Nevis</option>
<option value="St Lucia">St Lucia</option>
<option value="St Maarten">St Maarten</option>
<option value="St Pierre &amp; Miquelon">St Pierre &amp; Miquelon</option>
<option value="St Vincent &amp; Grenadines">St Vincent &amp; Grenadines</option>
<option value="Saipan">Saipan</option>
<option value="Samoa">Samoa</option>
<option value="Samoa American">Samoa American</option>
<option value="San Marino">San Marino</option>
<option value="Sao Tome &amp; Principe">Sao Tome &amp; Principe</option>
<option value="Saudi Arabia">Saudi Arabia</option>
<option value="Senegal">Senegal</option>
<option value="Serbia">Serbia</option>
<option value="Seychelles">Seychelles</option>
<option value="Sierra Leone">Sierra Leone</option>
<option value="Singapore">Singapore</option>
<option value="Slovakia">Slovakia</option>
<option value="Slovenia">Slovenia</option>
<option value="Solomon Islands">Solomon Islands</option>
<option value="Somalia">Somalia</option>
<option value="South Africa">South Africa</option>
<option value="Spain">Spain</option>
<option value="Sri Lanka">Sri Lanka</option>
<option value="Sudan">Sudan</option>
<option value="Suriname">Suriname</option>
<option value="Swaziland">Swaziland</option>
<option value="Sweden">Sweden</option>
<option value="Switzerland">Switzerland</option>
<option value="Syria">Syria</option>
<option value="Tahiti">Tahiti</option>
<option value="Taiwan">Taiwan</option>
<option value="Tajikistan">Tajikistan</option>
<option value="Tanzania">Tanzania</option>
<option value="Thailand">Thailand</option>
<option value="Togo">Togo</option>
<option value="Tokelau">Tokelau</option>
<option value="Tonga">Tonga</option>
<option value="Trinidad &amp; Tobago">Trinidad &amp; Tobago</option>
<option value="Tunisia">Tunisia</option>
<option value="Turkey">Turkey</option>
<option value="Turkmenistan">Turkmenistan</option>
<option value="Turks &amp; Caicos Is">Turks &amp; Caicos Is</option>
<option value="Tuvalu">Tuvalu</option>
<option value="Uganda">Uganda</option>
<option value="Ukraine">Ukraine</option>
<option value="United Arab Erimates">United Arab Emirates</option>
<option value="United Kingdom">United Kingdom</option>
<option value="United States of America">United States of America</option>
<option value="Uraguay">Uruguay</option>
<option value="Uzbekistan">Uzbekistan</option>
<option value="Vanuatu">Vanuatu</option>
<option value="Vatican City State">Vatican City State</option>
<option value="Venezuela">Venezuela</option>
<option value="Vietnam">Vietnam</option>
<option value="Virgin Islands (Brit)">Virgin Islands (Brit)</option>
<option value="Virgin Islands (USA)">Virgin Islands (USA)</option>
<option value="Wake Island">Wake Island</option>
<option value="Wallis &amp; Futana Is">Wallis &amp; Futana Is</option>
<option value="Yemen">Yemen</option>
<option value="Zaire">Zaire</option>
<option value="Zambia">Zambia</option>
<option value="Zimbabwe">Zimbabwe</option>
</select>
	      </div>
	</fieldset>
	
	<fieldset class="chapter article e-article paper newspaper-article">
	  <legend>Paginanummers:</legend>
	  <input class="pages from" placeholder="bv. '1'" type="number"></input><input class="pages to" placeholder="bv. '5'" type="number"></input>
	</fieldset>
	
	<fieldset class="e-article e-publication">
	  <legend>URL:</legend>
	  <input class="url" placeholder="bv. 'nl.wikipedia.org/wiki/Boerenzwaluw'" type="url"></input>
	</fieldset>
	
	<fieldset class="book chapter">
	  <legend>Druk:</legend>
	  <input class="print" placeholder="bv. '3'" type="number"></input>
	</fieldset>
	
	<fieldset class="book chapter">
	  <legend>Plaats:</legend>
	  <input class="place" placeholder="bv. 'Eindhoven'" type="text"></input>
	</fieldset>
	
	<fieldset class="book chapter">
	  <legend>Uitgever:</legend>
	  <input class="publisher" placeholder="bv. 'Elsevier'" type="text"></input>
	</fieldset>
	
	</div>
	</div>
	
      </div>
      
      <div class="draft"></div>
      
      <button class="add"><i class="fa fa-plus"></i> Toevoegen</button>
      <button><i class="fa fa-trash-o"></i> Concept verwijderen</button>
    
      </section>
      <section>

	<h2>Bewerken</h2>
	
	<fieldset>
	<select class="format">
	  <option value="EckartAPA">Eckartcolleges versie van APA</option>
	  <option value="APA">APA</option>
	  <option value="Vancouver">Vancouver</option>
	  <option value="JSON">JSON</option>
	  <option value="BibTeX">BibTeX</option>
	</select>
	</fieldset>
      
	<div class="wikipedia">
	  <!--<h3 class="wikititle"></h3> -->
	  <p class="wikiextract"></p>
	</div>

	<fieldset class="buttons">
	  <button><i class="fa fa-sort"></i> Sorteren</button>
	  <button><i class="fa fa-trash-o"></i> Leegmaken</button>
	</fieldset>
	
	<p>Onderstaand element is bewerkbaar</p>
	
      <div class="citations">
	<div class="citation activecitation" contenteditable="true" spellcheck="false"></div>
      </div>
      
    </section>
    <section>
    
      <h2>Meenemen</h2>
      
<!--       <p class="warning"><i class="fa fa-exclamation-triangle"></i> Je kan nog geen rijke tekst kopi&euml;ren. Je moet de titel in je bestand dus weer even in italics zetten of de bronnen zelf kopi&euml;ren</p> -->
      
      <fieldset class="buttons">
<!-- 	<button><i class="fa fa-files-o"></i> Kopi&euml;ren</button> -->
	<button><i class="fa fa-download"></i> Downloaden</button>
	<button><i class="fa fa-print"></i> Uitprinten</button>
      </fieldset>
    
    </section>
    
    </div>
    
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script src="http://danml.com/js/download.js"></script>
    <script type="text/javascript">
    function BibtexParser() {
  this.pos = 0;
  this.input = "";
  
  this.entries = {};
  this.comments = [];
  this.strings = {
      JAN: "January",
      FEB: "February",
      MAR: "March",      
      APR: "April",
      MAY: "May",
      JUN: "June",
      JUL: "July",
      AUG: "August",
      SEP: "September",
      OCT: "October",
      NOV: "November",
      DEC: "December"
  };
  this.currentKey = "";
  this.currentEntry = "";
  

  this.setInput = function(t) {
    this.input = t;
  }
  
  this.getEntries = function() {
      return this.entries;
  }

  this.isWhitespace = function(s) {
    return (s == ' ' || s == '\r' || s == '\t' || s == '\n');
  }

  this.match = function(s) {
    this.skipWhitespace();
    if (this.input.substring(this.pos, this.pos+s.length) == s) {
      this.pos += s.length;
    } else {
      throw "Token mismatch, expected " + s + ", found " + this.input.substring(this.pos);
    }
    this.skipWhitespace();
  }

  this.tryMatch = function(s) {
    this.skipWhitespace();
    if (this.input.substring(this.pos, this.pos+s.length) == s) {
      return true;
    } else {
      return false;
    }
    this.skipWhitespace();
  }

  this.skipWhitespace = function() {
    while (this.isWhitespace(this.input[this.pos])) {
      this.pos++;
    }
    if (this.input[this.pos] == "%") {
      while(this.input[this.pos] != "\n") {
        this.pos++;
      }
      this.skipWhitespace();
    }
  }

  this.value_braces = function() {
    var bracecount = 0;
    this.match("{");
    var start = this.pos;
    while(true) {
      if (this.input[this.pos] == '}' && this.input[this.pos-1] != '\\') {
        if (bracecount > 0) {
          bracecount--;
        } else {
          var end = this.pos;
          this.match("}");
          return this.input.substring(start, end);
        }
      } else if (this.input[this.pos] == '{') {
        bracecount++;
      } else if (this.pos == this.input.length-1) {
        throw "Unterminated value";
      }
      this.pos++;
    }
  }

  this.value_quotes = function() {
    this.match('"');
    var start = this.pos;
    while(true) {
      if (this.input[this.pos] == '"' && this.input[this.pos-1] != '\\') {
          var end = this.pos;
          this.match('"');
          return this.input.substring(start, end);
      } else if (this.pos == this.input.length-1) {
        throw "Unterminated value:" + this.input.substring(start);
      }
      this.pos++;
    }
  }
  
  this.single_value = function() {
    var start = this.pos;
    if (this.tryMatch("{")) {
      return this.value_braces();
    } else if (this.tryMatch('"')) {
      return this.value_quotes();
    } else {
      var k = this.key();
      if (this.strings[k/*.toUpperCase()*/]) {
        return this.strings[k];
      } else if (k.match("^[0-9]+$")) {
        return k;
      } else {
        throw "Value expected:" + this.input.substring(start);
      }
    }
  }
  
  this.value = function() {
    var values = [];
    values.push(this.single_value());
    while (this.tryMatch("#")) {
      this.match("#");
      values.push(this.single_value());
    }
    return values.join("");
  }

  this.key = function() {
    var start = this.pos;
    while(true) {
      if (this.pos == this.input.length) {
        throw "Runaway key";
      }
    
      if (this.input[this.pos].match("[a-zA-Z0-9_:\\./-]")) {
        this.pos++
      } else {
        return this.input.substring(start, this.pos)/*.toUpperCase()*/;
      }
    }
  }

  this.key_equals_value = function() {
    var key = this.key();
    if (this.tryMatch("=")) {
      this.match("=");
      var val = this.value();
      return [ key, val ];
    } else {
      throw "... = value expected, equals sign missing:" + this.input.substring(this.pos);
    }
  }

  this.key_value_list = function() {
    var kv = this.key_equals_value();
    this.entries[this.currentEntry][kv[0]] = kv[1];
    while (this.tryMatch(",")) {
      this.match(",");
      // fixes problems with commas at the end of a list
      if (this.tryMatch("}")) {
        break;
      }
      kv = this.key_equals_value();
      this.entries[this.currentEntry][kv[0]] = kv[1];
    }
  }

  this.entry_body = function(d) {
    this.currentEntry = this.key();
    this.entries[this.currentEntry] = { entryType: d.substring(1) };
    this.match(",");
    this.key_value_list();
  }

  this.directive = function () {
    this.match("@");
    return "@"+this.key();
  }

  this.string = function () {
    var kv = this.key_equals_value();
    this.strings[kv[0]/*.toUpperCase()*/] = kv[1];
  }

  this.preamble = function() {
    this.value();
  }

  this.comment = function() {
    var start = this.pos;
    while(true) {
      if (this.pos == this.input.length) {
        throw "Runaway comment";
      }
    
      if (this.input[this.pos] != '}') {
        this.pos++
      } else {
        this.comments.push(this.input.substring(start, this.pos));
        return;
      }
    }
  }

  this.entry = function(d) {
    this.entry_body(d);
  }

  this.bibtex = function() {
    while(this.tryMatch("@")) {
      var d = this.directive()/*.toUpperCase()*/;
      this.match("{");
      if (d == "@STRING") {
        this.string();
      } else if (d == "@PREAMBLE") {
        this.preamble();
      } else if (d == "@COMMENT") {
        this.comment();
      } else {
        this.entry(d);
      }
      this.match("}");
    }

    this.entries['@comments'] = this.comments;
  }
}

//Runs the parser
function doParse(input) {
  var b = new BibtexParser()
  b.setInput(input)
  b.bibtex()
  return b.entries
}

// module.exports = doParse
    </script>
    <script type="text/javascript">
    /* FileSaver.js
 * A saveAs() FileSaver implementation.
 * 1.1.20151003
 *
 * By Eli Grey, http://eligrey.com
 * License: X11/MIT
 *   See https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md
 */

/*global self */
/*jslint bitwise: true, indent: 4, laxbreak: true, laxcomma: true, smarttabs: true, plusplus: true */

/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */

var saveAs = saveAs || (function(view) {
	"use strict";
	// IE <10 is explicitly unsupported
	if (typeof navigator !== "undefined" && /MSIE [1-9]\./.test(navigator.userAgent)) {
		return;
	}
	var
		  doc = view.document
		  // only get URL when necessary in case Blob.js hasn't overridden it yet
		, get_URL = function() {
			return view.URL || view.webkitURL || view;
		}
		, save_link = doc.createElementNS("http://www.w3.org/1999/xhtml", "a")
		, can_use_save_link = "download" in save_link
		, click = function(node) {
			var event = new MouseEvent("click");
			node.dispatchEvent(event);
		}
		, is_safari = /Version\/[\d\.]+.*Safari/.test(navigator.userAgent)
		, webkit_req_fs = view.webkitRequestFileSystem
		, req_fs = view.requestFileSystem || webkit_req_fs || view.mozRequestFileSystem
		, throw_outside = function(ex) {
			(view.setImmediate || view.setTimeout)(function() {
				throw ex;
			}, 0);
		}
		, force_saveable_type = "application/octet-stream"
		, fs_min_size = 0
		// See https://code.google.com/p/chromium/issues/detail?id=375297#c7 and
		// https://github.com/eligrey/FileSaver.js/commit/485930a#commitcomment-8768047
		// for the reasoning behind the timeout and revocation flow
		, arbitrary_revoke_timeout = 500 // in ms
		, revoke = function(file) {
			var revoker = function() {
				if (typeof file === "string") { // file is an object URL
					get_URL().revokeObjectURL(file);
				} else { // file is a File
					file.remove();
				}
			};
			if (view.chrome) {
				revoker();
			} else {
				setTimeout(revoker, arbitrary_revoke_timeout);
			}
		}
		, dispatch = function(filesaver, event_types, event) {
			event_types = [].concat(event_types);
			var i = event_types.length;
			while (i--) {
				var listener = filesaver["on" + event_types[i]];
				if (typeof listener === "function") {
					try {
						listener.call(filesaver, event || filesaver);
					} catch (ex) {
						throw_outside(ex);
					}
				}
			}
		}
		, auto_bom = function(blob) {
			// prepend BOM for UTF-8 XML and text/* types (including HTML)
			if (/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(blob.type)) {
				return new Blob(["\ufeff", blob], {type: blob.type});
			}
			return blob;
		}
		, FileSaver = function(blob, name, no_auto_bom) {
			if (!no_auto_bom) {
				blob = auto_bom(blob);
			}
			// First try a.download, then web filesystem, then object URLs
			var
				  filesaver = this
				, type = blob.type
				, blob_changed = false
				, object_url
				, target_view
				, dispatch_all = function() {
					dispatch(filesaver, "writestart progress write writeend".split(" "));
				}
				// on any filesys errors revert to saving with object URLs
				, fs_error = function() {
					if (target_view && is_safari && typeof FileReader !== "undefined") {
						// Safari doesn't allow downloading of blob urls
						var reader = new FileReader();
						reader.onloadend = function() {
							var base64Data = reader.result;
							target_view.location.href = "data:attachment/file" + base64Data.slice(base64Data.search(/[,;]/));
							filesaver.readyState = filesaver.DONE;
							dispatch_all();
						};
						reader.readAsDataURL(blob);
						filesaver.readyState = filesaver.INIT;
						return;
					}
					// don't create more object URLs than needed
					if (blob_changed || !object_url) {
						object_url = get_URL().createObjectURL(blob);
					}
					if (target_view) {
						target_view.location.href = object_url;
					} else {
						var new_tab = view.open(object_url, "_blank");
						if (new_tab == undefined && is_safari) {
							//Apple do not allow window.open, see http://bit.ly/1kZffRI
							view.location.href = object_url
						}
					}
					filesaver.readyState = filesaver.DONE;
					dispatch_all();
					revoke(object_url);
				}
				, abortable = function(func) {
					return function() {
						if (filesaver.readyState !== filesaver.DONE) {
							return func.apply(this, arguments);
						}
					};
				}
				, create_if_not_found = {create: true, exclusive: false}
				, slice
			;
			filesaver.readyState = filesaver.INIT;
			if (!name) {
				name = "download";
			}
			if (can_use_save_link) {
				object_url = get_URL().createObjectURL(blob);
				save_link.href = object_url;
				save_link.download = name;
				setTimeout(function() {
					click(save_link);
					dispatch_all();
					revoke(object_url);
					filesaver.readyState = filesaver.DONE;
				});
				return;
			}
			// Object and web filesystem URLs have a problem saving in Google Chrome when
			// viewed in a tab, so I force save with application/octet-stream
			// http://code.google.com/p/chromium/issues/detail?id=91158
			// Update: Google errantly closed 91158, I submitted it again:
			// https://code.google.com/p/chromium/issues/detail?id=389642
			if (view.chrome && type && type !== force_saveable_type) {
				slice = blob.slice || blob.webkitSlice;
				blob = slice.call(blob, 0, blob.size, force_saveable_type);
				blob_changed = true;
			}
			// Since I can't be sure that the guessed media type will trigger a download
			// in WebKit, I append .download to the filename.
			// https://bugs.webkit.org/show_bug.cgi?id=65440
			if (webkit_req_fs && name !== "download") {
				name += ".download";
			}
			if (type === force_saveable_type || webkit_req_fs) {
				target_view = view;
			}
			if (!req_fs) {
				fs_error();
				return;
			}
			fs_min_size += blob.size;
			req_fs(view.TEMPORARY, fs_min_size, abortable(function(fs) {
				fs.root.getDirectory("saved", create_if_not_found, abortable(function(dir) {
					var save = function() {
						dir.getFile(name, create_if_not_found, abortable(function(file) {
							file.createWriter(abortable(function(writer) {
								writer.onwriteend = function(event) {
									target_view.location.href = file.toURL();
									filesaver.readyState = filesaver.DONE;
									dispatch(filesaver, "writeend", event);
									revoke(file);
								};
								writer.onerror = function() {
									var error = writer.error;
									if (error.code !== error.ABORT_ERR) {
										fs_error();
									}
								};
								"writestart progress write abort".split(" ").forEach(function(event) {
									writer["on" + event] = filesaver["on" + event];
								});
								writer.write(blob);
								filesaver.abort = function() {
									writer.abort();
									filesaver.readyState = filesaver.DONE;
								};
								filesaver.readyState = filesaver.WRITING;
							}), fs_error);
						}), fs_error);
					};
					dir.getFile(name, {create: false}, abortable(function(file) {
						// delete file if it already exists
						file.remove();
						save();
					}), abortable(function(ex) {
						if (ex.code === ex.NOT_FOUND_ERR) {
							save();
						} else {
							fs_error();
						}
					}));
				}), fs_error);
			}), fs_error);
		}
		, FS_proto = FileSaver.prototype
		, saveAs = function(blob, name, no_auto_bom) {
			return new FileSaver(blob, name, no_auto_bom);
		}
	;
	// IE 10+ (native saveAs)
	if (typeof navigator !== "undefined" && navigator.msSaveOrOpenBlob) {
		return function(blob, name, no_auto_bom) {
			if (!no_auto_bom) {
				blob = auto_bom(blob);
			}
			return navigator.msSaveOrOpenBlob(blob, name || "download");
		};
	}

	FS_proto.abort = function() {
		var filesaver = this;
		filesaver.readyState = filesaver.DONE;
		dispatch(filesaver, "abort");
	};
	FS_proto.readyState = FS_proto.INIT = 0;
	FS_proto.WRITING = 1;
	FS_proto.DONE = 2;

	FS_proto.error =
	FS_proto.onwritestart =
	FS_proto.onprogress =
	FS_proto.onwrite =
	FS_proto.onabort =
	FS_proto.onerror =
	FS_proto.onwriteend =
		null;

	return saveAs;
}(
	   typeof self !== "undefined" && self
	|| typeof window !== "undefined" && window
	|| this.content
));
// `self` is undefined in Firefox for Android content script context
// while `this` is nsIContentFrameMessageManager
// with an attribute `content` that corresponds to the window

if (typeof module !== "undefined" && module.exports) {
  module.exports.saveAs = saveAs;
} else if ((typeof define !== "undefined" && define !== null) && (define.amd != null)) {
  define([], function() {
    return saveAs;
  });
}
    </script>
    <script type="text/javascript">
    if (typeof jQuery !== "undefined" && typeof saveAs !== "undefined") {
    (function($) {
        $.fn.wordExport = function(fileName) {
            fileName = typeof fileName !== 'undefined' ? fileName : "jQuery-Word-Export";
            var static = {
                mhtml: {
                    top: "Mime-Version: 1.0\nContent-Base: " + location.href + "\nContent-Type: Multipart/related; boundary=\"NEXT.ITEM-BOUNDARY\";type=\"text/html\"\n\n--NEXT.ITEM-BOUNDARY\nContent-Type: text/html; charset=\"utf-8\"\nContent-Location: " + location.href + "\n\n<!DOCTYPE html>\n<html>\n_html_</html>",
                    head: "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<style>\n_styles_\n</style>\n</head>\n",
                    body: "<body>_body_</body>"
                }
            };
            var options = {
                maxWidth: 624
            };
            // Clone selected element before manipulating it
            var markup = $(this).clone();

            // Remove hidden elements from the output
            markup.each(function() {
                var self = $(this);
                if (self.is(':hidden'))
                    self.remove();
            });

            // Embed all images using Data URLs
            var images = Array();
            var img = markup.find('img');
            for (var i = 0; i < img.length; i++) {
                // Calculate dimensions of output image
                var w = Math.min(img[i].width, options.maxWidth);
                var h = img[i].height * (w / img[i].width);
                // Create canvas for converting image to data URL
                var canvas = document.createElement("CANVAS");
                canvas.width = w;
                canvas.height = h;
                // Draw image to canvas
                var context = canvas.getContext('2d');
                context.drawImage(img[i], 0, 0, w, h);
                // Get data URL encoding of image
                var uri = canvas.toDataURL("image/png");
                $(img[i]).attr("src", img[i].src);
                img[i].width = w;
                img[i].height = h;
                // Save encoded image to array
                images[i] = {
                    type: uri.substring(uri.indexOf(":") + 1, uri.indexOf(";")),
                    encoding: uri.substring(uri.indexOf(";") + 1, uri.indexOf(",")),
                    location: $(img[i]).attr("src"),
                    data: uri.substring(uri.indexOf(",") + 1)
                };
            }

            // Prepare bottom of mhtml file with image data
            var mhtmlBottom = "\n";
            for (var i = 0; i < images.length; i++) {
                mhtmlBottom += "--NEXT.ITEM-BOUNDARY\n";
                mhtmlBottom += "Content-Location: " + images[i].location + "\n";
                mhtmlBottom += "Content-Type: " + images[i].type + "\n";
                mhtmlBottom += "Content-Transfer-Encoding: " + images[i].encoding + "\n\n";
                mhtmlBottom += images[i].data + "\n\n";
            }
            mhtmlBottom += "--NEXT.ITEM-BOUNDARY--";

            //TODO: load css from included stylesheet
            var styles = $('.mine').html();
            var styles = 'span.i{font-style:italic;}'

            // Aggregate parts of the file together
            var fileContent = static.mhtml.top.replace("_html_", static.mhtml.head.replace("_styles_", styles) + static.mhtml.body.replace("_body_", markup.html())) + mhtmlBottom;

            // Create a Blob with the file contents
            var blob = new Blob([fileContent], {
                type: "application/msword;charset=utf-8"
            });
            saveAs(blob, fileName + ".doc");
        };
    })(jQuery);
} else {
    if (typeof jQuery === "undefined") {
        console.error("jQuery Word Export: missing dependency (jQuery)");
    }
    if (typeof saveAs === "undefined") {
        console.error("jQuery Word Export: missing dependency (FileSaver.js)");
    }
}</script>
    <script type="text/javascript">
    var bib = function(){
      
      // Check if exists
      
      function check(selector) {
	if ($(selector).val()!=undefined&&$(selector).val()!=null) {
	  return true
	}
	else {
	  return false
	}
      }
      
      function check2(vari) {
	var res = false;
	if (vari!=undefined&&vari!=null&&!isNaN(vari)) {
	  res = true
	}
	return res;
      }
    
      // Initiate first source
      
      var src ;
      
      function initiate() {
	src = []
	src[0] = {};
	src[0].type = $('.type').val();
	src[0].date = {from:[],to:[]};
	src[0].pubdate = {from:[],to:[]};
	src[0].con = {};
	src[0].con.date = {from:[],to:[]};
	src[0].pages = [];
      }
    
      initiate();
      
      var draftsrc ;
      
      function clrDraft() {
	draftsrc = {};
	draftsrc.type = $('.type').val();
	draftsrc.date = {from:[],to:[]};
	draftsrc.pubdate = {from:[],to:[]};
	draftsrc.con = {};
	draftsrc.con.date = {from:[],to:[]};
	draftsrc.pages = [];
      }
    
      clrDraft();
    
      function things(optionlan,optiontype,optionformat){
    
      // Defining dictionary
      
      var words = [
      {
	nl:'Binnengehaald op',
	en:'Citated on'
      },
      {
	nl:'van',
	en:'from'
      },
      {
	nl:'Paper gepresenteerd op de',
	en:'Paper presented at the'
      },
      {
	nl:'Bronnen maken | C[1]',
	en:'Citation generator | C[1]'
      },
      {
	nl:'Lees meer',
	en:'Read more'
      },
      {
	nl:'druk',
	en:'print'
      },
      {
	nl:'editie',
	en:'edition'
      },
      {
	nl:'Internet',
	en:'Internet'
      },      
      {
	nl:'Beschikbaar op',
	en:'Available from'
      }
      ];
      
      var wikiwords = [
	{
	lan:'nl',
	words:{
		APA:'APA-stijl',
		BibTeX:'BibTeX',
		Vancouver: 'APA-stijl',
		JSON:'JSON',
		EckartAPA:'APA-stijl'
	      }
	},
	{
	lan:'en',
	words:{
		APA:'APA_style',
		BibTeX:'BibTeX',
		Vancouver: 'Vancouver_system',
		JSON:'JSON',
		EckartAPA:'APA_style'
	      }
	}
      ];
    
      // Defining standard settings
    
      var formatstyle = optionformat;
      var lan = optionlan;
      var type4 = optiontype;
    
      // Some basic jQuery
      
      var currentTime = new Date();
      $('.year').attr('max',currentTime.getFullYear());
      
      var elemclass4 = '.container.'+lan;
      $('.container').addClass('invisible');
      $(elemclass4).removeClass('invisible');
      document.title = words[3][lan];
      
//       $('.wikiextract').before('<i class="fa fa-wikipedia-w"></i>:');
      
      /*$('.author, .red, .place').change(function(){
	if ($(this).val()!=null&&$(this).val()!=undefined&&$(this).val()!='') {
	  $(this).after('<input class="' + $(this).attr('class') + ' new" placeholder="bv. \'Jan van der Linden\'" type="text"></input>');
	  $('.author.new, .red.new, .place.new').change(function(){
	    if ($(this).val()!=null&&$(this).val()!=undefined&&$(this).val()!='') {
	      $(this).after('<input class="' + $(this).attr('class') + '" placeholder="bv. \'Jan van der Linden\'" type="text"></input>');
	    }
	    else if ($(this).val()==null||$(this).val()==undefined||$(this).val()=='') {
	      $(this).next().remove()
	    }
	  });
	}
	else if ($(this).val()==null||$(this).val()==undefined||$(this).val()=='') {
	  $(this).next().remove()
	}
      });
      
      /*$('.container:not(.invisible) .wikiheader').click(function(){
      if (!$('.container:not(.invisible) .wikipedia').hasClass('wikiactive')) {
	$('.container:not(.invisible) .wikipedia').slideDown();
	$('.container:not(.invisible) .wikipedia').addClass('wikiactive');
	$('.container:not(.invisible) .wikiheader i').html('&#9660;');
      }
      else if ($('.container:not(.invisible) .wikipedia').hasClass('wikiactive')) {
	$('.container:not(.invisible) .wikipedia').slideUp();
	$('.container:not(.invisible) .wikipedia').removeClass('wikiactive');
	$('.container:not(.invisible) .wikiheader i').html('&#9654;');
      }
      });*/
      
      //The thing that makes the correct things apear
      
      function displayInput(value) {
	$('.container:not(.invisible) .infoinput fieldset').each(function(){
	if ($(this).hasClass(value)) {
	  $(this).removeClass('invisible');
	}
	else  {
	  $(this).addClass('invisible');
	}
	});
      }
      
      displayInput(type4);
      
      function switchinput(elem) {
	var elemclass1 = elem.html();
	var elemclass2 = '.inputtype'+elemclass1.toLowerCase();
	var elemclass3 = '.inputtypechoice>a:contains('+elemclass1+')';
	$('.activeinputtype').removeClass('activeinputtype');
	$('.active').removeClass('active');
	$(elemclass2).addClass('activeinputtype');
	$(elemclass3).addClass('active');
      }     
      
      // The really difficult name formatter
    
      function name(str, type) {
	var res = '';						// Sets result to empty string
	function name1(amp) {
	  if (Array.isArray(str)) {				// Checks if array (multiple names)
	  var b = '';
	  for (i=0;i<str.length;++i) {				// Loops trough every full name
	    if (str.indexOf(',')>0) {b+=str}else{		// Checks if name isn't already formatted (and appends name to res if it is)
	    var a = str[i].replace(/-/g,' ').split(' ');	// Splits each full name into names (e.g. 'Jan', 'van', etc.)
	    b+=a[(a.length-1)] + ',';	 			// Adds last name to b
	    for (j=0;j<(a.length-1);++j) {			// Loops trough every name
	      if (a[j][0] === a[j][0].toUpperCase()) {		// Checks if first letter is capital
		b+=' ' + a[j][0] + '.';				// Appends initials to b
	      }
	      else {
		b+=' ' + a[j];					// Appends 'voorvoegsels' to b
	      }
	    };}
	    if (i!=str.length-1&&i!=str.length-2) {		// Checks if not last name
	      b += ', '						// Appends comma between names
	    }
	    else if (i==str.length-2) {				// Checks if last name
	      b += amp						// Appends '&' between names
	    }
	  };
	  res+=b						// Appends b (list of formatted names) to res (result)
	  }
	  else if (typeof str === 'string') {			// Checks if string (one name)
	    if (str.indexOf(',')>0) {res+=str}			// Checks if name isn't already formatted (and appends name to res if it is)
	    else{
	    var b = '';
	    var a = str.replace(/-/g,' ').split(' ');		// Splits each full name into names (e.g. 'Jan', 'van', etc.)
	    b+=a[(a.length-1)] + ',';				// Adds last name to b
	    for (j=0;j<(a.length-1);++j) {  			// Loops trough every name
	      if (a[j][0] === a[j][0].toUpperCase()) {		// Checks if first letter is capital
		b+=' ' + a[j][0] + '.';				// Appends initials to b
	      }
	      else {
		b+=' ' + a[j];					// Appends 'voorvoegsels' to b
	      }
	    };
	    res+=b						// Appends b (formatted name) to res (result)
	    }
	  };
	}
	function name2() {
	  if (Array.isArray(str)) {				// Checks if array (multiple names)
	  var b = '';
	  for (i=0;i<str.length;++i) {				// Loops trough every full name
	    if (str.indexOf(',')>0) {b+=str}			// Checks if name isn't already formatted (and appends name to res if it is)
	    else{
	    var f = '';						// Sets f to empty string
	    var l = '';						// Sets l to empty string
	    var a = str[i].replace(/-/g,' ').split(' ');	// Splits each full name into names (e.g. 'Jan', 'van', etc.)
	    for (j=0;j<(a.length-1);++j) {			// Loops trough every name
	      if (a[j][0] === a[j][0].toUpperCase()) {		// Checks if first letter is capital
		f+=a[j][0];					// Appends initials to b
	      }
	      else {
		l+=a[j] + ' ';					// Appends 'voorvoegsels' to l (last name)
	      }
	    };
	    l+=a[(a.length-1)]					// Appends last name to l (last name)
	    }
	    b+=l+' '+f;						// Appends l (last name) and f (first name) to b (formatted name)
	    if (i<str.length-1){				// Checks if not last name
	      b += ', '						// Appends ', ' between names
	    }
	  };
	  res+=b						// Appends b (list of formatted names) to res (result)
	  }
	  else if (typeof str === 'string') {			// Checks if string (one name)
	    if (str.indexOf(',')>0) {b+=str}			// Checks if name isn't already formatted (and appends name to res if it is)
	    else{
	    var b = '';
	    var f = '';						// Sets f to empty string
	    var l = '';						// Sets l to empty string
	    var a = str.replace(/-/g,' ').split(' ');		// Splits each full name into names (e.g. 'Jan', 'van', etc.)
	    for (j=0;j<(a.length-1);++j) {			// Loops trough every name
	      if (a[j][0] === a[j][0].toUpperCase()) {		// Checks if first letter is capital
		f+=a[j][0];					// Appends initials to b
	      }
	      else {
		l+=a[j] + ' ';					// Appends 'voorvoegsels' to l (last name)
	      }
	    };
	    l+=a[(a.length-1)]					// Appends last name to l (last name)
	    b+=l+' '+f;
	    res+=b						// Appends b (formatted name) to res (result)
	    }
	  };
	}
	if (type =='APA') {
	  name1(', &amp; ')
	}
	else if (type == 'EckartAPA') {
	  name1(' &amp; ')
	}
	else if (type == 'Vancouver') {
	  name2()
	}
	else if (type == 'BibTeX') {
	  name1(' and ')
	}
	return res;
      };
    
      // Set place to print citations
    
      var holder = '.container:not(.invisible) .citation.activecitation';
      var draftholder = '.container:not(.invisible) .draft';
      
      // Basic function: copy
      
      CopyToClipboard = function(text, fallback){
	var fb = function () {
	  $t.remove();
	  if (fallback !== undefined && fallback) {
	      var fs = 'Please, copy the following text:';
	      if (window.prompt(fs, text) !== null) return true;
	    }
	  return false;
	};
	var $t = $('<textarea />');
	$t.val(text).css({
	  width: '100px',
	  height: '40px',
	  border: 'none'
	}).appendTo('body');
	$t.select();
	try {
	  if (document.execCommand('copy')) {
	    $t.remove();
	    return true;
	  }
	  fb();
	}
	catch (e) {
	  fb();
	}
      };
      
      // Basic function: sort array of objects
      
      function compareAPA(a,b) {
	if (a.chapterauthor!=undefined||a.chapterauthor!=null) {
	  a.author = a.chapterauthor;
	}
	if (b.chapterauthor!=undefined||b.chapterauthor!=null) {
	  b.author = b.chapterauthor;
	}
	if (typeof a.author === 'string'&&typeof b.author === 'string') {
	  var arra = a.author.split(' ')
	  var arrb = b.author.split(' ')
	  if (arra[arra.length-1] < arrb[arrb.length-1]) {
	    return -1;
	  }
	  if (arra[arra.length-1] > arrb[arrb.length-1]) {
	    return 1;
	  }
	  return 0;
	}
	else if (typeof a.author != 'string'&&typeof b.author != 'string') {
	  var arra = a.author[0].split(' ')
	  var arrb = b.author[0].split(' ')
	  if (arra[arra.length-1] < arrb[arrb.length-1]) {
	    return -1;
	  }
	  if (arra[arra.length-1] > arrb[arrb.length-1]) {
	    return 1;
	  }
	  return 0;
	}
	else if (typeof a.author != 'string'&&typeof b.author === 'string') {
	  var arra = a.author[0].split(' ')
	  var arrb = b.author.split(' ')
	  if (arra[arra.length-1] < arrb[arrb.length-1]) {
	    return -1;
	  }
	  if (arra[arra.length-1] > arrb[arrb.length-1]) {
	    return 1;
	  }
	  return 0;
	}
	else if (typeof a.author === 'string'&&typeof b.author != 'string') {
	  var arra = a.author.split(' ')
	  var arrb = b.author[0].split(' ')
	  if (arra[arra.length-1] < arrb[arrb.length-1]) {
	    return -1;
	  }
	  if (arra[arra.length-1] > arrb[arrb.length-1]) {
	    return 1;
	  }
	  return 0;
	}
      }
      
      function compareBibTeX(a,b) {
	var stra = '';
	if (a.author != null && a.author != undefined) { stra += name(a.author,'APA').split(',')[0].toLowerCase(); };
	if (a.year != null && a.year != undefined) { stra += a.year.toString(); };
	if (a.title != null && a.title != undefined) { stra += a.title.split(' ')[0].toLowerCase(); };
	var strb = '';
	if (b.author != null && b.author != undefined) { strb += name(b.author,'APA').split(',')[0].toLowerCase(); };
	if (b.year != null && b.year != undefined) { strb += b.year.toString(); };
	if (b.title != null && b.title != undefined) { strb += b.title.split(' ')[0].toLowerCase(); };
	if (stra < strb) {
	  return -1;
	}
	if (stra > strb) {
	  return 1;
	}
	return 0;
      }
      
      // Date Input to Date output
      
      function dateInputOutput(date) {
	var res = [];
	var arr = date.toString().split('-').reverse();
	for (q=0;q<arr.length;++q) {
	  res[q] = parseInt(arr[q]);
	};
	return res;
      }
      
      // Basic function: Last digit
      
      function lastDigit(num) {
	return parseInt(num.toString()[num.toString().length-1])
      }
      
      // Number to rank
      
      function numToRank(num,lan) {
	var res = num.toString();
	var rank = [];
	if (lan =='nl') {
	  rank = ['ste','de','de','de']
	  if (num<3&&num!=0) {
	    res+=rank[num-1]
	  }
	  else if (num<19) {
	    res+=rank[3]
	  }
	  else if (num=>20){
	    res+=rank[0]
	  }
	}
	else if (lan == 'en'||lan =='bx') {
	  rank = ['st','nd','rd','th']
	  if (lastDigit(num) > 3) {
	    res += rank[3]
	  }
	  else if ((lastDigit(num)<=3&&lastDigit(num)!=0)&&(num<10||num>19)) {
	    res += rank[lastDigit(num)-1]
	  }
	  else {
	    res += rank[3]
	  }
	}
	return res;
      }
      
      // Buttons
     
      function clear() {
	initiate();
	start(src,formatstyle,lan,holder);
      }
      
      function clearForm() {
	$('.inputtypeinput.activeinputtype input, .inputtypeinput.activeinputtype select').each(function(){
	  $(this).val('');
	});
	clrDraft();
      }
      
      function srcsort() {
	if (formatstyle=='APA'||formatstyle=="EckartAPA") {
	  src.sort(compareAPA);	  
	}
	else if (formatstyle=='BibTeX') {
	  src.sort(compareBibTeX);
	}
	start(src,formatstyle,lan,holder);
      }
        
      //Testsource
      
      var testsrc = [
	{
	  type: 'boek',
	  author: 'Jan Aarts',
	  year: 2001,
	  title: 'Titel',
	  print: 3,
	  place: ['Locatie','Plaats'],
	  publisher: 'Uitgever'
	},
	{
	  type: 'boek',
	  author: ['Jan van den Bomen', 'Henk-Jan Bosch'],
	  red: 'Jan van der Linden',
	  year: 2001,
	  title: 'Titel',
	  place: 'Plaats',
	  publisher: 'Uitgever'
	},
	{
	  type: 'hoofdstuk',
	  chapterauthor: ['Jan Cock', 'Albert Heijn'],
	  author: ['Jan Linders', 'Jan Bosch'],
	  red: 'Jan van der Linden',
	  year: 2001,
	  chapter: 'Hoofdstuk',
	  title: 'Titel',
	  pages: [1,21],
	  place: 'Plaats',
	  publisher: 'Uitgever'
	},
	{
	  type: 'artikel',
	  author: ['Jan Dick', 'Jan Bosch'],
	  year: 2001,
	  title: 'Naam artikel',
	  journal: 'Tijdschrift',
	  volume: 2,
	  number: 4,
	  pages: [1,21]
	},
	{
	  type: 'e-artikel',
	  author: ['Jan van Eersel', 'Jan Bosch'],
	  year: 2001,
	  title: 'Naam artikel',
	  journal: 'Tijdschrift',
	  volume: 2,
	  number: 4,
	  date: {from:[1,12,2015]},
	  url: 'nl.wikipedia.org'
	},
	{
	  type: 'e-publicatie',
	  author: ['Jan Fitzherbert', 'Jan Bosch'],
	  year: 2001,
	  pubdate: {from:[1,2,2015]},
	  title: 'Titel',
	  date: {from:[1,12,2015]},
	  url: 'nl.wikipedia.org'
	},
	{
	  type: 'paper',
	  author: ['Jan Goelikkers', 'Jan Bosch'],
	  title: 'Titel',
	  con: {name:'Conferentie',org:'Gebouw of organisatie',place:'Plaats',country:'Nederland'},
	  date: {from:[1,2,2015],to:[3,2,2015]}
	},
	{
	  type: 'krantenartikel',
	  author: ['Jan Hoofd', 'Jan Bosch'],
	  pubdate: {from:[1,2,2015]},
	  title: 'Titel',
	  journal: 'Volkskrant',
	  pages: [3,5]
	}
      ];
      
      var testsrc2 = [
	{type:'book',author:'C D'},
	{type:'book',author:'A B'},
	{type:'book',author:'gt v'},
	{type:'book',author:'d Asd'},
	{type:'book',author:'Ma'}
      ];
      
      // Basic function: find with attr
      
      function findWithAttr(arr, attr, value) {
	for(var i = 0; i < arr.length; i += 1) {
	  if(arr[i][attr] === value) {
            return i;
	  }
	}
      }
      
      // Basic function: shuffle array
      
      function shuffleArr(array) {
	var currentIndex = array.length, temporaryValue, randomIndex ;
	  while (0 !== currentIndex) {
	  randomIndex = Math.floor(Math.random() * currentIndex);
	  currentIndex -= 1;
	  temporaryValue = array[currentIndex];
	  array[currentIndex] = array[randomIndex];
	  array[randomIndex] = temporaryValue;
	}

	return array;
      }
      
      // Basic function: array to string
      
      function arrToStr(arr,prefix,affix) {
	var res = '';
	for (o=0;o<arr.length;++o) {
	  res += prefix + arr[o] + affix
	};
	return res;
      }
    
      // Basic function: object to string
      
      function objToStr(obj) {
	var string = [];
	if (typeof(obj) == "object" && (obj.join == undefined)) {
	  string.push("{");
	  for (prop in obj) {
            string.push(prop, ": ", objToStr(obj[prop]), ",");
	  };
	  string.push("}");
	}
	else {
	  string.push(JSON.stringify(obj))
	}

	return string.join("")
      }
    
      // Basic function: string to object
    
      function strToObj(str) {
	var fields = str.replace(/[^a-zA-Z0-9:, ]+/g,"").split(','),
		     fieldObject = {};

	if(typeof fields === 'object'&&Array.isArray(fields)) {
	  for (s=0;s<fields.length;s++)  {
	    var c = fields[s].replace(': ',':').split(':');
	    fieldObject[c[0].replace(/[^a-zA-Z0-9]+/g,"")] = c[1];
	  };
	}
	else if( typeof fields === 'object') {
	  var c = property.split('|');
	    fieldObject[c[0].replace(/[^a-zA-Z0-9]+/g,"")] = c[1];
	}
	return fieldObject;
	/*var obj = str.replace(/'/g, '"').replace(/"/g, '\\"').replace(/'/g, "\\'").replace(/"/g, '\\"');
	console.log(str)
	console.log(obj)
	return JSON.parse(obj)/**/
      }
      
      function bibToObj(str) {
	var bib = doParse(str);
	var arr = Object.keys(bib);
	var label;
	for(a=0;a<arr.length;a++){if(arr[a].indexOf('comments')<0){
	  label = arr[a] }
	}
	var obj = bib[label]
	if(check2(bib[label].title)){obj.title = bib[label].title.replace(/{/g,'').replace(/}/g,'');}
	if(check2(bib[label].chapterauthor)){obj.chapterauthor = bib[label].chapterauthor.split(' and ');}
	if(check2(bib[label].author)){obj.author = bib[label].author.split(' and ');}
	if(check2(bib[label].red)){obj.red = bib[label].red.split(' and ');}
	obj.place = bib[label].location;
	delete obj.location;
	obj.type = bib[label].entryType;
	delete obj.entryType;
	return obj;
      }
    
      // For testing:
      //src = testsrc;
      //src = shuffleArr(src);
    
      function start(src,selectstyle,selectlan,place) {
      
      // Date to country-specific notation formatter
      
      function date(date,lan) {
	res = '';
	if (lan == 'nl') {
	  var months = ['Januari','Februari','Maart','April','Mei','Juni','Juli','Augustus','September','Oktober','November','December']
	}
	else if (lan == 'en'||lan == 'bx') {
	  var months = ['January','February','March','April','May','June','July','August','September','October','November','December']
	}
	if ((date.from.length!=0&&date.to.length!=0)&&date.from!=date.to) {
	  if (date.from[1]!=date.to[1]) {
	    if (lan == 'nl' || lan == 'en') {res += date.from[0].toString()+' '+months[(date.from[1]-1)].toLowerCase()+' '+date.from[2].toString()+' - '+date.to[0].toString() +' '+ months[(date.to[1]-1)].toLowerCase() +' '+ date.to[2].toString()}
	  }
	  else if (date.from[0]!=date.to[0]) {
	    if (lan == 'nl' || lan == 'en') {res += date.from[0].toString()+ ' - ' + date.to[0].toString()+' '+months[(date.from[1]-1)].toLowerCase()+' '+date.from[2].toString()}
	  }
	}
	else if ((date.from.length!=0&&date.to.length==0)||(date.from==date.to&&date.from.length!=0)) {
	  if (lan == 'nl' || lan == 'en') {res += date.from[0].toString() +' '+ months[(date.from[1]-1)].toLowerCase() +' '+ date.from[2].toString();}
	  else if (lan == 'bx') {res += date.from[0].toString() +'-'+ months[(date.from[1]-1)] +'-'+ date.from[2].toString();}
	}
	return res;
      }
      
      // The compiler of authors and redactions
      
      function compiler(src, type) {
	var arr = [];
	if (Array.isArray(src.author)) {
	  arr=arr.concat(src.author)
	}
	else if (typeof src.author === 'string') {
	  arr.push(src.author);
	}
	if (Array.isArray(src.red)) {
	  for (m=0;m<src.red.length;++m) {
	    var ma = m + arr.length;
	    arr[ma] = src.author[m];
	  };
	}
	else if (typeof src.red === 'string') {
	  arr.push(src.red);
	}
	return name(arr, type);
      }
      
      // The JSON-to-HTML formatter
    
      function htmlformatter(src, style, lan) {
	var res = /*src.type.replace(src.type[0], src.type[0].toUpperCase()) + ': '*/ '' ;
	// APA-style bibliography in HTML
	if (style == 'APA' || style == 'EckartAPA') {
	res += '<p>'
	var word = [];
	for (t=0;t<words.length;++t) {
	  word[t] = words[t][lan]
	}
 	// The book formatter
   	if (src.type.toLowerCase() == 'boek' || src.type.toLowerCase() == 'book') {
 	  if ((src.author != null && src.author != undefined)&&(src.red == null || src.red == undefined)) {
	    res += name(src.author, style) + ' ';
  	  }
  	  else if ((src.author!=null&&src.author!=undefined)&&(src.red!=null&&src.red!=undefined)) {
  	    res += compiler(src, style) + ' (red.) ';
  	  }
 	  else if ((src.red!=null&&src.red!=undefined)&&(src.author==null||src.author==undefined)) {
	    res += name(src.red, style) + ' (red.) ';
  	  }
 	  if (src.year != null && src.year != undefined) {
	    res += '(' + src.year.toString() + ')';
  	  }
  	  if ((src.year != null && src.year != undefined)||(src.author != null && src.author != undefined)||(src.red != null && src.red != undefined)) { res+='. '}
 	  if (src.title != null && src.title != undefined) {
	    res += '<span class="i">' + src.title + '</span>.';
  	  }
 	  if (src.print != null && src.print != undefined) {
	    res += ' (' + src.print + '<sup>e</sup> '+word[5]+') ';
  	  }
 	  if (src.place != null && src.place != undefined) {
	    res += ' ';
	    if (Array.isArray(src.place)) {
	      for (n=0;n<(src.place.length-1);++n){
		res += src.place[n] + '/';
	      };
	      res += src.place[(src.place.length-1)];
	    }
	    else { res += src.place; }
	    res +=  ':';
  	  }
 	  if (src.publisher != null && src.publisher != undefined) {
	    res += ' ' + src.publisher + '.';
  	  }
   	}
 	// The chapter formatter
   	else if (src.type.toLowerCase() == 'hoofdstuk' || src.type.toLowerCase() == 'chapter') {
 	  if ((src.chapterauthor != null && src.chapterauthor != undefined)&&(src.chapterred == null || src.chapterred == undefined)) {
	    res += name(src.chapterauthor, style) + ' ';
  	  }
  	  else if ((src.chapterauthor!=null&&src.chapterauthor!=undefined)&&(src.chapterred!=null&&src.chapterred!=undefined)) {
  	    res += ' ' + compiler(src, style) + ' (red.) ';
  	  }
 	  else if ((src.red!=null&&src.red!=undefined)&&(src.author==null||src.author==undefined)) {
	    res += ' ' + name(src.chapterred, style) + ' (red.) ';
  	  }
 	  if (src.year != null && src.year != undefined) {
	    res += '(' + src.year.toString() + ')';
  	  }
  	  if ((src.year != null && src.year != undefined)||(src.chapterauthor != null && src.chapterauthor != undefined)||(src.chapterred != null && src.chapterred != undefined)) { res+='. '}
 	  if (src.chapter != null && src.chapter != undefined) {
	    res += src.chapter + '. ';
  	  }
 	  if ((src.author != null && src.author != undefined)&&(src.red == null || src.red == undefined)) {
	    res += 'In ' + name(src.author, style) + ' ';
  	  }
  	  else if ((src.author!=null&&src.author!=undefined)&&(src.red!=null&&src.red!=undefined)) {
  	    res += 'In ' + compiler(src, style) + ' (red.) ';
  	  }
 	  else if ((src.red!=null&&src.red!=undefined)&&(src.author==null||src.author==undefined)) {
	    res += 'In ' + name(src.red, style) + ' (red.) ';
  	  }
 	  if (src.title != null && src.title != undefined) {
	    res += '<span class="i">' + src.title + '</span>, ';
  	  }
 	  if (src.pages != null && src.pages != undefined) {
	    res += ' ( p. ' + src.pages[0].toString() + '-' + src.pages[1].toString() + ' ) ';
  	  }
 	  if (src.place != null && src.place != undefined) {
	    if (Array.isArray(src.place)) {
	      for (n=0;n<(src.place.length-1);++n){
		res += src.place[n] + '/';
	      };
	      res += src.place[(src.place.length-1)];
	    }
	    else { res += src.place; }
	    res +=  ': ';
  	  }
 	  if (src.publisher != null && src.publisher != undefined) {
	    res += src.publisher + '.';
  	  }
   	}
   	// The article formatter
   	else if (src.type.toLowerCase() == 'artikel' || src.type.toLowerCase() == 'article') {
 	  if (src.author != null && src.author != undefined) {
	    res += name(src.author, style) + ' ';
  	  }
 	  if (src.year != null && src.year != undefined) {
	    res += '(' + src.year.toString() + ')';
  	  }
  	  if ((src.year != null && src.year != undefined)||(src.author != null && src.author != undefined)||(src.red != null && src.red != undefined)) { res+='. '}
 	  if (src.title != null && src.title != undefined) {
	    res += src.title + '. ';
  	  }
 	  if (src.journal != null && src.journal != undefined) {
	    res += '<span class="i">' + src.journal;
  	  }
 	  if (src.volume != null && src.volume != undefined) {
	    res += ', ' + src.volume + '</span>';
  	  }
 	  if (src.number != null && src.number != undefined) {
	    res += '(' + src.number + ')';
  	  }
 	  if (src.pages != null && src.pages != undefined) {
	    res += ', ' + src.pages[0].toString() + '-' + src.pages[1].toString() + '.';
  	  }
   	}
   	// The e-article formatter
   	else if (src.type.toLowerCase() == 'e-artikel' || src.type.toLowerCase() == 'e-article') {
 	  if (src.author != null && src.author != undefined) {
	    res += name(src.author, style) + ' ';
  	  }
 	  if (src.year != null && src.year != undefined) {
	    res += '(' + src.year.toString() + ')';
  	  }
  	  if ((src.year != null && src.year != undefined)||((src.year != null && src.year != undefined)&&(src.author != null && src.author != undefined))) { res+='. '}
 	  if (src.title != null && src.title != undefined) {
	    res += src.title + '. ';
  	  }
 	  if (src.journal != null && src.journal != undefined) {
	    res += '<span class="i">' + src.journal;
  	  }
 	  if (src.volume != null && src.volume != undefined) {
	    res += ', ' + src.volume + '</span>';
  	  }
 	  if (src.number != null && src.number != undefined) {
	    res += '(' + src.number + ')';
  	  }
 	  if (src.pages != null && src.pages != undefined) {
	    res += '. ' + src.pages[0].toString() + '-' + src.pages[1].toString() + '.';
  	  }
 	  if (check2(src.date.from[0])||check2(src.date.to[0])) {
	    res += '. ' + word[0] + ' ' + date(src.date,lan);
  	  }
 	  if (src.url != null && src.url != undefined) {
	    res += ', ' + word[1] + ' <a class="link" href="https://' + src.url.replace('https://','').replace('http://','') + '" >' + src.url + '</a>';
  	  }
   	}
   	// The e-publication formatter
   	else if (src.type.toLowerCase() == 'e-publicatie' || src.type.toLowerCase() == 'e-publication') {
 	  if (src.author != null && src.author != undefined) {
	    res += name(src.author, style) + ' ';
  	  }
 	  if (check2(src.pubdate.from[2])) {
	    res += '(' + src.pubdate.from[2].toString();
  	  }
  	  if (check2(src.pubdate.from[0])||check2(src.pubdate.to[0])) {
	    var datum = src.pubdate.from[2]
	    src.pubdate.from[2]= '';
	    res +=  '/' + date(src.pubdate,lan);
	    src.pubdate.from[2]= datum;
  	  }
  	  res += ')'
  	  if ((src.pubdate.from != null && src.pubdate.from != undefined)||((src.pubdate.from != null && src.pubdate.from != undefined)&&(src.author != null && src.author != undefined))) { res+='. '}
 	  if (src.title != null && src.title != undefined) {
	    res += '<span class="i">' + src.title + '</span>';
  	  }
 	  if (check2(src.date.from[0])||check2(src.date.to[0])) {
	    res += '. ' + word[0] + ' ' + date(src.date,lan);
  	  }
 	  if (src.url != null && src.url != undefined) {
	    res += ', ' + word[1] + ' <a class="link" href="https://' + src.url.replace('https://','').replace('http://','') + '" >' + src.url + '</a>';
  	  }
   	}
   	// The conference paper formatter
   	else if (src.type.toLowerCase() == 'paper' || src.type.toLowerCase() == 'paper') {
 	  if (src.author != null && src.author != undefined) {
	    res += name(src.author, style) + ' ';
  	  }
  	  if (src.year!=null&&src.year!=undefined) {
	    res +=  '(' + src.year.toString() + ')';
  	  }
  	  if ((src.year != null && src.year != undefined)||((src.year != null && src.year != undefined)&&(src.author != null && src.author != undefined))) { res+='. '}
 	  if (src.title != null && src.title != undefined) {
	    res += '<span class="i">' + src.title + '</span>. ';
  	  }
  	  if (src.con != null && src.con != undefined) {
  	  if (src.con.name != null && src.con.name != undefined) {
	    res += word[2] + ' ' + src.con.name;
  	  }
  	  if (src.con.org != null && src.con.org != undefined) {
	    res += ', ' + src.con.org;
  	  }
  	  if (src.con.place != null && src.con.place != undefined) {
	    res += ', ';
	    if (Array.isArray(src.con.place)) {
	      for (n=0;n<(src.con.place.length-1);++n){
		res += src.con.place[n] + '/';
	      };
	      res += src.con.place[(src.place.con.length-1)];
	    }
	    else { res += src.con.place; }
	    res += ' ';
  	  }
  	  if (src.con.country != null && src.con.country != undefined) {
	    res += '(' + src.con.country + ')';
  	  }
  	  }
 	  if (src.date != null && src.date != undefined) {
	    res += ', ' + date(src.date,lan) + '.';
  	  }
   	}
   	// The newspaper formatter
   	else if (src.type.toLowerCase() == 'krantenartikel' || src.type.toLowerCase() == 'newspaper-article') {
 	  if (src.author != null && src.author != undefined) {
	    res += name(src.author, style);
  	  }
  	  if (check2(src.pubdate.from[1])) {
	    res +=  ' (' + date(src.pubdate,lan) + ')';
  	  }
  	  if (check2(src.pubdate)&&check2(src.author)) { res+='. '}
 	  if (src.title != null && src.title != undefined) {
	    res += src.title + '. ';
  	  }
 	  if (src.journal != null && src.journal != undefined) {
	    res += '<span class="i">' + src.journal + '</span>';
  	  }
 	  if (src.pages != null && src.pages != undefined) {
	    res += ', p.' + src.pages[0].toString() + '.';
  	  }
   	}
   	res += '</p>'
   	}
   	
   	// Vanoucer-style bibliography in HTML
   	/**/else if (style == 'Vancouver') {
   	res += '<p>'
	var word = [];
	for (t=0;t<words.length;++t) {
	  word[t] = words[t][lan]
	}
	
 	if (src.type.toLowerCase() == 'boek' || src.type.toLowerCase() == 'book') {
 	  if ((src.author != null && src.author != undefined)&&(src.red == null || src.red == undefined)) {
	    res += name(src.author, style);
  	  }
  	  else if ((src.author!=null&&src.author!=undefined)&&(src.red!=null&&src.red!=undefined)) {
  	    res += compiler(src, style) + ', editors';
  	  }
 	  else if ((src.red!=null&&src.red!=undefined)&&(src.author==null||src.author==undefined)) {
	    res += name(src.red, style) + ', editors';
  	  }
  	  if ((src.author != null && src.author != undefined)||(src.red != null && src.red != undefined)) { res+='. '}
 	  if (src.title != null && src.title != undefined) {
	    res += src.title + '. ';
  	  }
 	  if (src.print != null && src.print != undefined) {
	    res += numToRank(src.print,lan)+' '+word[6][0]+word[6][1]+'. ';
  	  }
 	  if (src.place != null && src.place != undefined) {
	    res += ' ';
	    if (Array.isArray(src.place)) {
	      for (n=0;n<(src.place.length-1);++n){
		res += src.place[n] + '/';
	      };
	      res += src.place[(src.place.length-1)];
	    }
	    else { res += src.place; }
	    res +=  ':';
  	  }
 	  if (src.publisher != null && src.publisher != undefined) {
	    res += ' ' + src.publisher;
  	  }
 	  if (src.year != null && src.year != undefined) {
	    res += '; ' + src.year.toString() + '.';
  	  }
   	}
	else if (src.type.toLowerCase() == 'hoofdstuk' || src.type.toLowerCase() == 'chapter') {
	  if (src.chapterauthor != null && src.chapterauthor != undefined) {
	    res += name(src.chapterauthor, style) + '. ';
	  }
 	  if (src.chapter != null && src.chapter != undefined) {
	    res += src.chapter + '. In: ';
  	  }
	  if ((src.author != null && src.author != undefined)&&(src.red == null || src.red == undefined)) {
	    res += name(src.author, style);
	  }
	  else if ((src.author!=null&&src.author!=undefined)&&(src.red!=null&&src.red!=undefined)) {
	    res += compiler(src, style) + ', editors';
	  }
	  else if ((src.red!=null&&src.red!=undefined)&&(src.author==null||src.author==undefined)) {
	    res += name(src.red, style) + ', editors';
	  }
	  if ((src.author != null && src.author != undefined)||(src.red != null && src.red != undefined)) { res+='. '}
	  if (src.title != null && src.title != undefined) {
	    res += src.title + '. ';
	  }
	  if (src.print != null && src.print != undefined) {
	    res += numToRank(src.print,lan)+' '+word[6][0]+word[6][1]+'. ';
	  }
	  if (src.place != null && src.place != undefined) {
	    res += ' ';
	    if (Array.isArray(src.place)) {
	      for (n=0;n<(src.place.length-1);++n){
		res += src.place[n] + '/';
	      };
	      res += src.place[(src.place.length-1)];
	    }
	    else { res += src.place; }
	    res +=  ':';
	  }
	  if (src.publisher != null && src.publisher != undefined) {
	    res += ' ' + src.publisher;
	  }
	  if (src.year != null && src.year != undefined) {
	    res += '; ' + src.year.toString() + '.';
	  }
	}
	else if (src.type.toLowerCase() == 'krantenartikel' || src.type.toLowerCase() == 'newspaper-article'||src.type.toLowerCase()=='article'||src.type.toLowerCase()=='artikel') {
	  if ((src.author != null && src.author != undefined)&&(src.red == null || src.red == undefined)) {
	    res += name(src.author, style);
	  }
	  else if ((src.author!=null&&src.author!=undefined)&&(src.red!=null&&src.red!=undefined)) {
	    res += compiler(src, style) + ', editors';
	  }
	  else if ((src.red!=null&&src.red!=undefined)&&(src.author==null||src.author==undefined)) {
	    res += name(src.red, style) + ', editors';
	  }
	  if ((src.author != null && src.author != undefined)||(src.red != null && src.red != undefined)) { res+='. '}
	  if (src.title != null && src.title != undefined) {
	    res += src.title + '. ';
	  }
	  if (src.journal != null && src.journal != undefined) {
	    res += src.journal;
  	  }
	  if (src.year != null && src.year != undefined) {
	    res += '. ' + src.year.toString() + ';';
	  }
 	  if (src.volume != null && src.volume != undefined) {
	    res += src.volume;
  	  }
 	  if (src.number != null && src.number != undefined) {
	    res += '(' + src.number + ')';
  	  }
 	  if (src.pages != null && src.pages != undefined) {
	    res += ':' + src.pages[0].toString() + '-' + src.pages[1].toString() + '.';
  	  }
	}
	else if (src.type.toLowerCase()=='e-article'||src.type.toLowerCase()=='e-artikel'||src.type.toLowerCase()=='e-publicatie'||src.type.toLowerCase()=='e-publication') {
	  if ((src.author != null && src.author != undefined)&&(src.red == null || src.red == undefined)) {
	    res += name(src.author, style);
	  }
	  else if ((src.author!=null&&src.author!=undefined)&&(src.red!=null&&src.red!=undefined)) {
	    res += compiler(src, style) + ', editors';
	  }
	  else if ((src.red!=null&&src.red!=undefined)&&(src.author==null||src.author==undefined)) {
	    res += name(src.red, style) + ', editors';
	  }
	  if ((src.author != null && src.author != undefined)||(src.red != null && src.red != undefined)) { res+='. '}
	  if (src.title != null && src.title != undefined) {
	    res += src.title + '. ';
	  }
	  if (src.journal != null && src.journal != undefined) {
	    res += src.journal + '['+word[6]+']';
  	  }
	  if (src.year != null && src.year != undefined) {
	    res += '. ' + src.year.toString() + ';';
	  }
 	  if (src.volume != null && src.volume != undefined) {
	    res += src.volume;
  	  }
 	  if (src.number != null && src.number != undefined) {
	    res += '(' + src.number + ')';
  	  }
 	  if (src.pages != null && src.pages != undefined) {
	    res += ':' + src.pages[0].toString() + '-' + src.pages[1].toString() + '.';
  	  }
 	  if (src.url != null && src.url != undefined) {
	    res += ' ' + word[7] + ': <a class="link" href="https://' + src.url.replace('https://','').replace('http://','') + '" >' + src.url + '</a>';
  	  }
	}
	res += '</p>'
	}/**/
	
	// BibTeX bibliography in HTML
	else if (style == 'BibTeX') {
	  res += '<div class="nomargin"><p>@';
	  if (src.type=='book'||src.type=='article') {
	    res += src.type;
	  }
	  else if (src.type=='boek') {
	    res += 'book';
	  }
	  else if (src.type=='krantenartikel'||src.type=='newspaper-article'||src.type=='e-artikel'||src.type=='artikel'||src.type=='e-publication'||src.type=='e-article'||src.type=='e-publicatie'||src.type=='paper') {
	    res+= 'article'
	  }
	  else {
	    res += 'misc';
	  }
	  res += '{';
	  if (src.author != null && src.author != undefined) { res += name(src.author,'APA').split(',')[0].toLowerCase(); };
	  if (src.year != null && src.year != undefined) { res += src.year.toString(); };
	  if (src.title != null && src.title != undefined) { res += src.title.split(' ')[0].toLowerCase(); };
	  res += ',</p>'
	  var arr = []
	  if (src.title != null && src.title != undefined) { arr[arr.length] = 'title={{'+src.title+'}}'; };
	  if (src.author != null && src.author != undefined) { arr[arr.length] = 'author={'+name(src.author, 'BibTeX')+'}'; };
	  if (src.newspaper != null && src.newspaper != undefined) { arr[arr.length] = 'journal={'+src.newspaper+'}'; };
	  if (src.volume != null && src.volume != undefined) { arr[arr.length] = 'volume={'+src.volume+'}'; };
	  if (src.number != null && src.number != undefined) { arr[arr.length] = 'number={'+src.number+'}'; };
	  if (src.pages != null && src.pages != undefined) { arr[arr.length] = 'pages={'+src.pages[0]+'--'+src.pages[1]+'}'; };
	  if (src.year != null && src.year != undefined) { arr[arr.length] = 'year={'+src.year.toString()+'}'; };
	  if (src.url != null && src.url != undefined) { arr[arr.length] = 'url={https://'+src.url.replace('https://','').replace('http://','')+'}';
	    if (src.date!= null && src.date != undefined) { arr[arr.length] = 'note={[Online; accesed '+date(src.date,'bx')+']}' }
	  };
	  if (src.place != null && src.place != undefined) { arr[arr.length] = 'city={'+src.place+'}'; };
	  if (src.publisher != null && src.publisher != undefined) { arr[arr.length] = 'publisher={'+src.publisher+'}'; };
	  res += arrToStr(arr,'<p class="indent1">',',</p>');
	  res += '<p>}</p></div>'
   	}
   	
   	// JSON object in HTML
   	else if (style == 'JSON') {
	  var obj = src;
	  var string = [];
	  if (typeof(obj) == "object" && (obj.join == undefined)) {
	    string.push("<div class=\"nomargin\"><p>{</p>");
	    for (prop in obj) {
	      string.push('<p class="indent1">',prop, ": ", objToStr(obj[prop]), ",</p>");
	    };
	    string.push("<p>}</p></div>");
	  }
	  else {
	    string.push(JSON.stringify(obj))
	  }
	  return string.join("")
   	}
	return res;
      };
            
      function printSrc() {
	var res = '';
	if (Array.isArray(src)) {
	for (k=0;k<src.length;++k) {
	  var str = htmlformatter(src[k],selectstyle,selectlan);
	  res += str;
	};
	}
	else {
	  var str = htmlformatter(src,selectstyle,selectlan);
	  res += str;
	}
	$(place).html(res);
      };
      printSrc();
      }
      
      // Updating
      
      function update(type) {
	var z = '.container:not(.invisible) ';
	draftsrc.type = type;
	if($(z+'.chapauthor').val()!=''){var str=$(z+'.chapauthor').val();if(Array.isArray(str)){for(x=0;x<str.length;x++){draftsrc.chapterauthor[x]=str[x]}}else{draftsrc.chapterauthor=$(z+'.chapauthor').val()}}
	if($(z+'.author').val()!=''){var str=$(z+'.author').val();if(Array.isArray(str)){for(x=0;x<str.length;x++){draftsrc.author[x]=str[x]}}else{draftsrc.author=$(z+'.author').val()}}
	if($(z+'.chapter').val()!=''){draftsrc.chapter=$(z+'.chapter').val()}
	if($(z+'.red').val()!=''){var str=$(z+'.red').val();if(Array.isArray(str)){for(x=0;x<str.length;x++){draftsrc.red[x]=str[x]}}else{draftsrc.red=$(z+'.red').val()}}
	if($(z+'.pubdate').val()!=''){draftsrc.pubdate.from=dateInputOutput($(z+'.pubdate').val())}
	if($(z+'.date').val()!=''){draftsrc.date.from=dateInputOutput($(z+'.date').val())}
	if($(z+'.condate.from').val()!=''){draftsrc.date.from=dateInputOutput($(z+'.condate.from').val())}
	if($(z+'.condate.to').val()!=''){draftsrc.date.to=dateInputOutput($(z+'.condate.to').val())}
	if(check2($(z+'.year').val())){draftsrc.year=$(z+'.year').val()}
	if($(z+'.journal').val()!=''){draftsrc.journal=$(z+'.journal').val()}
	if($(z+'.volume').val()!=NaN){draftsrc.volume=$(z+'.volume').val()}
	if($(z+'.number').val()!=NaN){draftsrc.number=$(z+'.number').val()}
	if($(z+'.title').val()!=''){draftsrc.title=$(z+'.title').val()}
	if($(z+'.conname').val()!=''){draftsrc.con.name=$(z+'.conname').val()}
	if($(z+'.conorg').val()!=''){draftsrc.con.org=$(z+'.conorg').val()}
	if($(z+'.conplace').val()!=''){draftsrc.con.place=$(z+'.conplace').val()}
	if($(z+'.concountry').val()!=''){draftsrc.con.country=$(z+'.concountry').val()}
	if($(z+'.pages.from').val()!=NaN&&$(z+'.pages.to').val()!=NaN){draftsrc.pages[0]=$(z+'.pages.from').val();draftsrc.pages[1]=$(z+'.pages.to').val()}
	if($(z+'.print').val()!=''){draftsrc.print=$(z+'.print').val()}
	if($(z+'.place').val()!=''){draftsrc.place=$(z+'.place').val()}
	if($(z+'.publisher').val()!=''){draftsrc.publisher=$(z+'.publisher').val()}
	if($(z+'.url').val()!=''){draftsrc.url=$(z+'.url').val()}
// 	draftsrc = testsrc[0];
	start(draftsrc,formatstyle,lan,draftholder);
      }
      
      update(type4);
            
      start(src,formatstyle,lan,holder);
      
      function wiki() {
	var url = "http://"+lan+".wikipedia.org/wiki/"+wikiwords[findWithAttr(wikiwords,'lan',lan)].words[formatstyle];
	var title = url.split("/");
	title = title[title.length - 1];

	//Get Leading paragraphs (section 0)
	$.getJSON("https://"+lan+".wikipedia.org/w/api.php?action=parse&page="+title+"&prop=text&section=0&format=json&callback=?", function (data) {
	  var text = data.parse.text['*'].split('</p>')[0].replace(/<p>/g,'').replace(/href="\/wiki/g,'href="https://'+lan+'.wikipedia.org/wiki').replace(/upload.wikimedia/g,'href="https://'+lan+'https://upload.wikimedia.');
// 	  $('.container:not(.invisible) .wikititle').html(title);
	  $('.container:not(.invisible) .wikiextract').html($('.container:not(.invisible) .wikiextract').text(text).get(0).textContent+' <a class="link" href="' + url + '">' + words[4][lan] + '</a>');
	  $('.container:not(.invisible) .wikiextract').find('table,img,div').remove();
	});
      }
      
      wiki();
      
      $('.options>a').click(function(){
	lan = $(this).attr('class');
	var elemclass4 = '.container.'+lan;
	$('.container').addClass('invisible');
	$(elemclass4).removeClass('invisible');
	document.title = words[3][lan];
	displayInput(type4);
	things(lan,type4,formatstyle);
      });
      $('.container:not(.invisible) select.format').change(function(){
	formatstyle = $(this).val();
	start(src,formatstyle,lan,holder);
	update(type4);
	wiki();
      });
      $('.container:not(.invisible) select.type').change(function(){
	type4 = ($(this).val());
	displayInput(type4);
	update(type4);
      });
      $('.container:not(.invisible) .inputtypeinput input, .container:not(.invisible) .inputtypeinput select:not(.type)').change(function(){
	update(type4);
      });
      
      $('textarea.JSON').change(function(){
	draftsrc = strToObj($(this).val());
	start(draftsrc,formatstyle,lan,draftholder);
      });
      
      $('textarea.BibTeX').change(function(){
	draftsrc = bibToObj($(this).val());
	start(draftsrc,formatstyle,lan,draftholder);
      });
      
      $('.inputtypechoice>a').click(function(){
	switchinput($(this));
      });
      
      $('button:contains("Leegmaken"),button:contains("Clear")').click(function(){
	clear();
      });
      
      $('button:contains("Sorteren"),button:contains("Sort")').click(function(){
	srcsort();
      });
      
      $('button:contains("Kopi"),button:contains("Copy")').click(function(){
	var txt = $(".container:not(.invisible) .citation").get(0).textContent;
	CopyToClipboard(txt,false);
//	CopyToClipBoard($(".container:not(.invisible) .citation"));
      });
      
      $('button:contains("Downloaden"),button:contains("Download")').click(function(){
	var time = new Date();
	var date = '_' + time.getDate() + '/' + time.getMonth() + '/' + time.getFullYear() + '_' + time.getHours() + '-' + time.getMinutes() + '-' + time.getSeconds()
	var elem = $(".container:not(.invisible) .citation");
	var txt = elem.get(0).textContent;
	if (formatstyle == 'APA' || formatstyle == 'EckartAPA') {
	  elem.wordExport(formatstyle + date);
	}
	else if (formatstyle == 'JSON') {
	  download(txt, formatstyle + date + ".js", "text/javascript")
	}
	else if (formatstyle == 'BibTeX') {
	  download(txt, formatstyle + date + ".bib", "application/x-bibtex")
	}
      });
            
      $('button:contains("Sorteren"),button:contains("Sort")').click(function(){
	srcsort();
      });
      
      $('button:contains("Concept"),button:contains("draft")').click(function(){
	clrDraft();
      });
      
      $('button:contains("Toevoegen"),button:contains("Add")').click(function(){
	src[src.length] = draftsrc;
	clrDraft()
	$('.container:not(.invisible) .draft').html('');
	start(src,formatstyle,lan,holder);
	$('.container:not(.invisible) .activecitation').removeClass('green').addClass('green');
      });
      
      $('button:contains("Uitprinten"),button:contains("Print")').click(function(){
	window.print()
      });
     
     }
     
     things('nl','book','EckartAPA');
     
    }
    $(document).ready(bib);
    </script>
</html>
